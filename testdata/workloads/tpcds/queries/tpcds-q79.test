====
---- QUERY : TPCDS-Q79
SELECT
  c_last_name,
  c_first_name,
  SUBSTR(s_city, 1, 30) AS ss_city,
  ss_ticket_number,
  amt,
  profit
FROM
  (SELECT
    ss_ticket_number,
    ss_customer_sk,
    s_city,
    SUM(ss_coupon_amt) AS amt,
    SUM(ss_net_profit) AS profit
  FROM tpcds.store_sales$TABLE ss
  JOIN tpcds.date_dim$TABLE d
    ON (ss.ss_sold_date_sk = d.d_date_sk)
  JOIN tpcds.household_demographics$TABLE hd
    ON (ss.ss_hdemo_sk = hd.hd_demo_sk)
  JOIN tpcds.store$TABLE s
    ON (ss.ss_store_sk = s.s_store_sk)
  WHERE
    (hd.hd_dep_count = 8
      OR hd.hd_vehicle_count > 0)
    AND d.d_dow = 1
    AND d.d_year IN (1998, 1998 + 1, 1998 + 2)
    AND s.s_number_employees BETWEEN 200 AND 295
  GROUP BY
    ss_ticket_number,
    ss_customer_sk,
    ss_addr_sk,
    s_city
  ) ms
JOIN tpcds.customer$TABLE c
  ON (ms.ss_customer_sk = c.c_customer_sk)
ORDER BY
  c_last_name,
  c_first_name,
  ss_city,
  profit
LIMIT 100;
---- RESULTS
'','','Fairview',173082,2592.210052490234,-34714.29029464722
'','','Fairview',28219,1069.690017700195,-30116.68023109436
'','','Fairview',111527,10507.00022697449,-26198.79975891113
'','','Fairview',158139,3721.389953613281,-23039.01017045975
'','','Fairview',64776,2881.250091552734,-22393.74952697754
'','','Fairview',86099,4060.789958953857,-18880.86980438232
'','','Fairview',144846,1227.949974060059,-18275.46017456055
'','','Fairview',200200,3615.019958496094,-18203.55001831055
'','','Fairview',191017,7900.209716796875,-18126.93991088867
'','','Fairview',131135,6276.109802246094,-17818.53011703491
'','','Fairview',30114,165.75,-17434.48009490967
'','','Fairview',232744,213.6199951171875,-14103.23980712891
'','','Fairview',106407,2358.02995300293,-13804.84979057312
'','','Fairview',167006,2257.970108032227,-13398.37984085083
'','','Fairview',13383,2539.190078735352,-13202.58000183105
'','','Fairview',39774,3002.770050048828,-13174.20978546143
'','','Fairview',93934,2221.250045776367,-12879.35989379883
'','','Fairview',206954,2942.790046691895,-12557.19991111755
'','','Fairview',95167,457.9299941062927,-12376.05013275146
'','','Fairview',209331,2898.06005859375,-11835.84997177124
'','','Fairview',195048,217.080005645752,-11041.33011627197
'','','Fairview',205061,2899.450019836426,-9926.140270233154
'','','Fairview',146799,1201.820014715195,-9526.129949569702
'','','Fairview',22706,1972.75,-8555.459930419922
'','','Fairview',162236,26.71000003814697,-8533.450056314468
'','','Fairview',34621,2129.849960327148,-7876.489837646484
'','','Fairview',199428,1108.380004882812,-7838.910036087036
'','','Fairview',202409,2997.489990234375,-7647.259857177734
'','','Fairview',19707,227.5,-7442.530040502548
'','','Fairview',61255,399.6399917602539,-7204.300201416016
'','','Fairview',125748,1068.989990234375,-6885.029918670654
'','','Fairview',15239,4157.929786682129,-5607.930004119873
'','','Fairview',147963,0,-5303.330017089844
'','','Fairview',163421,1367.409973144531,-4442.709784030914
'','','Fairview',175686,1425.720001220703,-3900.129989624023
'','','Fairview',142379,1419.980052947998,-3892.459808349609
'','','Fairview',230904,0,-2575.259828567505
'','','Fairview',66717,1521.090030670166,-2431.950015306473
'','','Fairview',198542,1082.910022735596,-1789.200014054775
'','','Fairview',202409,NULL,-1086.400024414062
'','','Fairview',131135,2281.60009765625,-1017.909973144531
'','','Fairview',7153,9.960000038146973,-984.6199684143066
'','','Fairview',104995,64.88999938964844,871
'','','Fairview',107943,579.8499755859375,1154.539855957031
'','','Fairview',5606,118.4499988555908,1180.890061855316
'','','Fairview',214859,2437.460048675537,2159.380060195923
'','','Fairview',222446,0,2355.360455274582
'','','Fairview',13383,NULL,NULL
'','','Midway',105150,6250.050003051758,-26967.15972900391
'','','Midway',9441,1109.310028076172,-26407.609993577
'','','Midway',179817,6836.129795074463,-25225.85953140259
'','','Midway',59758,11618.84007740021,-21841.15007019043
'','','Midway',179984,4391.979963302612,-20741.65012741089
'','','Midway',40873,3899.70011138916,-20442.44979858398
'','','Midway',6353,9905.849838256836,-19744.02993774414
'','','Midway',111877,6321.510009765625,-19177.95999145508
'','','Midway',90505,2096.849975585938,-19114.50003051758
'','','Midway',82226,0,-18280.38007354736
'','','Midway',217339,1865.02001953125,-17373.080078125
'','','Midway',212310,5259.049995422363,-17061.44005823135
'','','Midway',32000,2174.329956054688,-16884.96011352539
'','','Midway',79498,17184.32934570312,-16718.35014343262
'','','Midway',126973,2414.820007324219,-16704.22027587891
'','','Midway',214204,1524.889970779419,-16439.56973314285
'','','Midway',229921,3612.100059509277,-16374.26980364323
'','','Midway',229149,92.41999816894531,-16316.52016234398
'','','Midway',126979,341.800013422966,-16276.31005096436
'','','Midway',232945,5684.970092773438,-15711.18970680237
'','','Midway',57905,1398.429985046387,-15565.43005609512
'','','Midway',103927,4067.949905395508,-15388.67011404037
'','','Midway',174629,1170.519966125488,-15361.79021072388
'','','Midway',22249,283.7899875640869,-15294.15990447998
'','','Midway',219417,994.4099884033203,-15135.08042526245
'','','Midway',137440,4094.7099609375,-15047.66004753113
'','','Midway',138209,878.0900039672852,-14552.73998737335
'','','Midway',183077,13.85999965667725,-14304.21000671387
'','','Midway',7142,7853.499992370605,-14304.00008392334
'','','Midway',154925,0,-13975.29013299942
'','','Midway',178507,1287.730010986328,-13937.18014907837
'','','Midway',159742,3230.630004882812,-13929.02983093262
'','','Midway',123650,13957.66027832031,-13881.54993438721
'','','Midway',209032,2552.469882965088,-13554.24034500122
'','','Midway',30128,4143.260047912598,-13502.30992889404
'','','Midway',101168,1170.820007324219,-13378.72982692719
'','','Midway',123710,3740.080017089844,-13280.51987457275
'','','Midway',177932,5919.580087184906,-13201.49008464813
'','','Midway',64117,3900.849959611893,-13187.48999786377
'','','Midway',73809,10596.43017578125,-13032.16006374359
'','','Midway',201028,1395.370048522949,-12932.14033699036
'','','Midway',86777,1596.969985961914,-12846.14021682739
'','','Midway',16363,2779.590087890625,-12799.66021347046
'','','Midway',88444,290.1800000667572,-12645.67017221451
'','','Midway',186442,1171.06005859375,-12532.74993896484
'','','Midway',78861,2664.169982910156,-12455.12967967987
'','','Midway',223610,277.1100044250488,-12432.76008224487
'','','Midway',132138,2164.589965820312,-12162.01964569092
'','','Midway',42870,834.2100219726562,-12044.32988739014
'','','Midway',185866,1172.460021972656,-12011.29005920887
'','','Midway',203991,3950.570007324219,-12006.60995292664
'','','Midway',100755,1506.480033874512,-11700.52007770538
---- TYPES
STRING, STRING, STRING, INT, DOUBLE, DOUBLE
====