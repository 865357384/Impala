====
---- QUERY : TPCDS-Q27
SELECT
  i_item_id,
  s_state,
  AVG(ss_quantity) agg1,
  AVG(ss_list_price) agg2,
  AVG(ss_coupon_amt) agg3,
  AVG(ss_sales_price) agg4
FROM tpcds.store_sales$TABLE ss
JOIN tpcds.date_dim$TABLE d
  ON (ss.ss_sold_date_sk = d.d_date_sk)
JOIN tpcds.item$TABLE i
  ON (ss.ss_item_sk = i.i_item_sk)
JOIN tpcds.customer_demographics$TABLE cd
  ON (ss.ss_cdemo_sk = cd.cd_demo_sk)
JOIN tpcds.store$TABLE s
  ON (ss.ss_store_sk = s.s_store_sk)
WHERE
  cd_gender = 'M'
  AND cd_marital_status = 'S'
  AND cd_education_status = 'College'
  AND d_year = 2002
  AND s_state IN ('TN', 'SD')
GROUP BY
  i_item_id,
  s_state
ORDER BY
  i_item_id,
  s_state
LIMIT 100
---- RESULTS
'AAAAAAAAAAABAAAA','TN',46,114.7200012207031,0,32.11999893188477
'AAAAAAAAAAAEAAAA','TN',100,77.97000122070312,0,57.68999862670898
'AAAAAAAAAABAAAAA','TN',6,48.88999938964844,13.60999965667725,2.440000057220459
'AAAAAAAAAACAAAAA','TN',62,32.21333281199137,0,5.506666580835978
'AAAAAAAAAACDAAAA','TN',97,161.7799987792969,0,55
'AAAAAAAAAADBAAAA','TN',28,136.0099945068359,575.760009765625,73.44000244140625
'AAAAAAAAAADCAAAA','TN',64,116.1399993896484,0,108.0100021362305
'AAAAAAAAAAEBAAAA','TN',9,5.429999828338623,0,5.210000038146973
'AAAAAAAAAAEDAAAA','TN',45.5,87.63500213623047,0,51.83999824523926
'AAAAAAAAAAGBAAAA','TN',29,101.9400024414062,0,100.9199981689453
'AAAAAAAAAAGCAAAA','TN',97,65.26999664306641,0,21.53000068664551
'AAAAAAAAAAGEAAAA','TN',55,73.875,0,70.99999809265137
'AAAAAAAAAAHAAAAA','TN',20,134.3000030517578,0,119.5199966430664
'AAAAAAAAAAHBAAAA','TN',97,7.400000095367432,0,6.730000019073486
'AAAAAAAAAAHDAAAA','TN',69,5.619999885559082,0,0.3300000131130219
'AAAAAAAAAAIAAAAA','TN',87,106.9800033569336,0,27.80999946594238
'AAAAAAAAAAKBAAAA','TN',84.5,66.17500114440918,847.8350219726562,57.3799991607666
'AAAAAAAAAALAAAAA','TN',6,32.27999877929688,0,7.420000076293945
'AAAAAAAAAALCAAAA','TN',98,34.31000137329102,55.29999923706055,1.710000038146973
'AAAAAAAAAALDAAAA','TN',59,129.4700012207031,713.9000244140625,22
'AAAAAAAAAANAAAAA','TN',74,60.875,0,13.19999980926514
'AAAAAAAAAANBAAAA','TN',96,130.7899932861328,1864.510009765625,129.4799957275391
'AAAAAAAAAAOAAAAA','TN',85,130.3399963378906,0,122.5100021362305
'AAAAAAAAAAOCAAAA','TN',14,64.57500076293945,0,33.97499942779541
'AAAAAAAAAAODAAAA','TN',84,30.5,0,28.96999931335449
'AAAAAAAAAAPBAAAA','TN',45,118.8899955749512,2380.594970703125,84.71500015258789
'AAAAAAAAABAAAAAA','TN',97,124.75,0,74.84999847412109
'AAAAAAAAABABAAAA','TN',31,29.97999954223633,17.09000015258789,27.57999992370605
'AAAAAAAAABAEAAAA','TN',34,17.20999908447266,0,13.42000007629395
'AAAAAAAAABCBAAAA','TN',38,131.3749961853027,0,52.3199987411499
'AAAAAAAAABDAAAAA','TN',31.5,68.34499931335449,0,63.27499771118164
'AAAAAAAAABDBAAAA','TN',56,103.8499984741211,1624.170043945312,59.18999862670898
'AAAAAAAAABDDAAAA','TN',67.33333333333333,119.4199981689453,23.18666585286458,38.72000018755595
'AAAAAAAAABDEAAAA','TN',61,85.94999885559082,2282.359985351562,44.60499954223633
'AAAAAAAAABEDAAAA','TN',61,85.13999938964844,0,50.22999954223633
'AAAAAAAAABFBAAAA','TN',31,23.54999923706055,0,13.64999961853027
'AAAAAAAAABFCAAAA','TN',83,15.5,0,0
'AAAAAAAAABGAAAAA','TN',64,35.08000183105469,0,3.150000095367432
'AAAAAAAAABGBAAAA','TN',40,25.06999969482422,0,16.04000091552734
'AAAAAAAAABGEAAAA','TN',39.5,56.76500034332275,14.25500011444092,36.00500106811523
'AAAAAAAAABHAAAAA','TN',93,74.80000305175781,0,21.69000053405762
'AAAAAAAAABHCAAAA','TN',31.5,79.83499789237976,181.3800048828125,61.93500089645386
'AAAAAAAAABIBAAAA','TN',48,170.8899993896484,0,140.1199951171875
'AAAAAAAAABJAAAAA','TN',46.5,82.32500076293945,0,44.98500061035156
'AAAAAAAAABJBAAAA','TN',76,12.39999961853027,0,3.960000038146973
'AAAAAAAAABJDAAAA','TN',34,118.504997253418,0,61.20500183105469
'AAAAAAAAABKAAAAA','TN',65,8.774999856948853,0,5.179999798536301
'AAAAAAAAABKCAAAA','TN',26,51.56999969482422,0,41.25
'AAAAAAAAABLBAAAA','TN',61.5,149.1199951171875,0,82.54000091552734
'AAAAAAAAABMAAAAA','TN',14,109.9700012207031,0,10.98999977111816
'AAAAAAAAABMDAAAA','TN',97,104.870002746582,0,34.59999847412109
'AAAAAAAAABNAAAAA','TN',13.5,17.39500045776367,0,2.024999976158142
'AAAAAAAAABOBAAAA','TN',66,112.8600006103516,0,24.81999969482422
'AAAAAAAAABPAAAAA','TN',19,67.33000183105469,268.6000061035156,16.82999992370605
'AAAAAAAAABPDAAAA','TN',37,41.15999984741211,0,20.22500038146973
'AAAAAAAAACACAAAA','TN',53,132.5,0,15.89999961853027
'AAAAAAAAACADAAAA','TN',73,76.58999633789062,782.5599975585938,21.44000053405762
'AAAAAAAAACBBAAAA','TN',82,75.21999931335449,277.5499877929688,10.24000000953674
'AAAAAAAAACBCAAAA','TN',53,35.45999908447266,0,21.97999954223633
'AAAAAAAAACBEAAAA','TN',49,113.2050018310547,1902.144958496094,75.13999938964844
'AAAAAAAAACCAAAAA','TN',60,111.870002746582,0,74.94999694824219
'AAAAAAAAACCEAAAA','TN',89,73.98999786376953,0,4.429999828338623
'AAAAAAAAACDAAAAA','TN',35,86.56999842325847,0,22.6333335240682
'AAAAAAAAACDCAAAA','TN',30,68.03499794006348,0,55.59000205993652
'AAAAAAAAACDDAAAA','TN',67.66666666666667,21.3266658782959,0,7.830000122388204
'AAAAAAAAACEBAAAA','TN',69.5,81.93999862670898,0,29.78999948501587
'AAAAAAAAACECAAAA','TN',89,47.09999847412109,0,20.71999931335449
'AAAAAAAAACFBAAAA','TN',70,14.60000038146973,0,8.460000038146973
'AAAAAAAAACFDAAAA','TN',53,106.1600036621094,0,91.29000091552734
'AAAAAAAAACFEAAAA','TN',40.33333333333334,103.4166666666667,0,18.00666681925456
'AAAAAAAAACGAAAAA','TN',41,10,0,6.699999809265137
'AAAAAAAAACGDAAAA','TN',4,6.320000171661377,0,3.720000028610229
'AAAAAAAAACHBAAAA','TN',51,67.85000260670979,1521.279947916667,54.99000199635824
'AAAAAAAAACHCAAAA','TN',4,101.1800003051758,0,97.12999725341797
'AAAAAAAAACKBAAAA','TN',96,123.4400024414062,0,122.1999969482422
'AAAAAAAAACKCAAAA','TN',44,48.70999908447266,0,23.86000061035156
'AAAAAAAAACLDAAAA','TN',50,130.8000030517578,0,13.07999992370605
'AAAAAAAAACMDAAAA','TN',33,91.52999877929688,0,71.38999938964844
'AAAAAAAAACNCAAAA','TN',27,69.83999633789062,0,27.93000030517578
'AAAAAAAAACODAAAA','TN',54,57.73000049591064,0,7.78000020980835
'AAAAAAAAACPAAAAA','TN',36,103.0299987792969,0,97.87000274658203
'AAAAAAAAADABAAAA','TN',20,194.7599945068359,0,5.840000152587891
'AAAAAAAAADAEAAAA','TN',53,65.66000366210938,0,53.84000015258789
'AAAAAAAAADBAAAAA','TN',48,87.48999786376953,0,74.78999900817871
'AAAAAAAAADBBAAAA','TN',88,48.86000061035156,0,9.770000457763672
'AAAAAAAAADBDAAAA','TN',41,27.6200008392334,380.2699890136719,13.25
'AAAAAAAAADBEAAAA','TN',33.5,112.4199981689453,0,55.36499977111816
'AAAAAAAAADCAAAAA','TN',59,5.429999828338623,0,4.880000114440918
'AAAAAAAAADDBAAAA','TN',25,149.6699981689453,0,125.7200012207031
'AAAAAAAAADDEAAAA','TN',54,11.80000019073486,0,8.260000228881836
'AAAAAAAAADEAAAAA','TN',23,132.6799926757812,0,30.51000022888184
'AAAAAAAAADEDAAAA','TN',99,48.88999938964844,0,48.88999938964844
'AAAAAAAAADFAAAAA','TN',67.5,45.22000026702881,0,19.09500002861023
'AAAAAAAAADFCAAAA','TN',77,101.7900009155273,0,39.68999862670898
'AAAAAAAAADFDAAAA','TN',94,79.81999969482422,414.8599853515625,63.04999923706055
'AAAAAAAAADGCAAAA','TN',19,14.27000045776367,0,5.559999942779541
'AAAAAAAAADGEAAAA','TN',75.66666666666667,123.3100026448568,413.1300048828125,51.38666661580404
'AAAAAAAAADHBAAAA','TN',15,179.1300048828125,496.4400024414062,39.40000152587891
'AAAAAAAAADHDAAAA','TN',98,39.29999923706055,0,33.79000091552734
'AAAAAAAAADIAAAAA','TN',27,124.5100021362305,0,107.0699996948242
---- TYPES
STRING, STRING, DOUBLE, DOUBLE, DOUBLE, DOUBLE
====