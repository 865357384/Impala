====
---- QUERY : TPCDS-Q43
SELECT
  s_store_name,
  s_store_id,
  SUM(CASE WHEN (d_day_name='Sunday') THEN ss_sales_price ELSE NULL END) AS sun_sales,
  SUM(CASE WHEN (d_day_name='Monday') THEN ss_sales_price ELSE NULL END) AS mon_sales,
  SUM(CASE WHEN (d_day_name='Tuesday') THEN ss_sales_price ELSE NULL END) AS tue_sales,
  SUM(CASE WHEN (d_day_name='Wednesday') THEN ss_sales_price ELSE NULL END) AS wed_sales,
  SUM(CASE WHEN (d_day_name='Thursday') THEN ss_sales_price ELSE NULL END) AS thu_sales,
  SUM(CASE WHEN (d_day_name='Friday') THEN ss_sales_price ELSE NULL END) AS fri_sales,
  SUM(CASE WHEN (d_day_name='Saturday') THEN ss_sales_price ELSE NULL END) AS sat_sales
FROM store_sales ss
JOIN date_dim d
  ON (ss.ss_sold_date_sk = d.d_date_sk)
JOIN store s
  ON (ss.ss_store_sk = s.s_store_sk)
WHERE
  s_gmt_offset = -5
  AND d_year = 1998
GROUP BY
  s_store_name,
  s_store_id
ORDER BY
  s_store_name,
  s_store_id,
  sun_sales,
  mon_sales,
  tue_sales,
  wed_sales,
  thu_sales,
  fri_sales,
  sat_sales
LIMIT 100;
---- RESULTS
'able','AAAAAAAACAAAAAAA',459564.3503271807,492832.2100329716,472234.8901050892,513998.9199012257,480718.609844353,480887.3002229743,482390.9301320352
'ation','AAAAAAAAHAAAAAAA',468604.3999698255,467302.0998666603,470821.4899354447,510779.7102150209,481377.2101618778,473673.4900250658,471487.619951481
'bar','AAAAAAAAKAAAAAAA',495341.9798941873,461667.2799212318,476791.3800257184,498368.240080256,475762.4301457983,476690.9799174499,462227.2199031953
'eing','AAAAAAAAIAAAAAAA',487998.3202690408,460740.3700316567,486454.0600421708,447624.8700172994,468239.1598914023,468815.8596502747,502495.1601744927
'ese','AAAAAAAAEAAAAAAA',466373.1498161983,477718.0200482495,486363.5901071876,490049.1201024838,483203.2497753464,470427.7701355629,497738.0200316478
'ought','AAAAAAAABAAAAAAA',442199.1700444855,483945.9701020271,497270.7901850808,483466.9199192971,496373.0900244247,491362.249864677,462524.8701078314
---- TYPES
STRING, STRING, DOUBLE, DOUBLE, DOUBLE, DOUBLE, DOUBLE, DOUBLE, DOUBLE
====
