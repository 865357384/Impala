select name, zip
from functional.testtbl
order by name
limit 1
---- PLAN
Plan Fragment 0
  UNPARTITIONED
  TOP-N
  ORDER BY: name ASC
  LIMIT: 1
  TUPLE IDS: 0 
    SCAN HDFS table=functional.testtbl #partitions=0 size=0B (0)
      TUPLE IDS: 0 
---- DISTRIBUTEDPLAN
Plan Fragment 0
  UNPARTITIONED
  TOP-N
  ORDER BY: name ASC
  LIMIT: 1
  TUPLE IDS: 0 
    EXCHANGE (2)
      TUPLE IDS: 0 

Plan Fragment 1
  RANDOM
  STREAM DATA SINK
    EXCHANGE ID: 2
    UNPARTITIONED

  TOP-N
  ORDER BY: name ASC
  LIMIT: 1
  TUPLE IDS: 0 
    SCAN HDFS table=functional.testtbl #partitions=0 size=0B (0)
      TUPLE IDS: 0 
---- SCANRANGELOCATIONS
NODE 0:
====
select zip, count(*)
from functional.testtbl
where name like 'm%'
group by 1
order by 2 desc
limit 10
---- PLAN
Plan Fragment 0
  UNPARTITIONED
  TOP-N
  ORDER BY: <slot 3> DESC
  LIMIT: 10
  TUPLE IDS: 1 
    AGGREGATE
    OUTPUT: COUNT(*)
    GROUP BY: zip
    TUPLE IDS: 1 
      SCAN HDFS table=functional.testtbl #partitions=0 size=0B (0)
        PREDICATES: name LIKE 'm%'
        TUPLE IDS: 0 
---- DISTRIBUTEDPLAN
Plan Fragment 0
  UNPARTITIONED
  TOP-N
  ORDER BY: <slot 3> DESC
  LIMIT: 10
  TUPLE IDS: 1 
    AGGREGATE
    OUTPUT: SUM(<slot 3>)
    GROUP BY: <slot 2>
    TUPLE IDS: 1 
      EXCHANGE (3)
        TUPLE IDS: 1 

Plan Fragment 1
  RANDOM
  STREAM DATA SINK
    EXCHANGE ID: 3
    UNPARTITIONED

  AGGREGATE
  OUTPUT: COUNT(*)
  GROUP BY: zip
  TUPLE IDS: 1 
    SCAN HDFS table=functional.testtbl #partitions=0 size=0B (0)
      PREDICATES: name LIKE 'm%'
      TUPLE IDS: 0 
---- SCANRANGELOCATIONS
NODE 0:
====
select int_col, sum(float_col) 
from functional.hbasealltypessmall
where id < 5
group by 1
order by 2
limit 4
---- PLAN
Plan Fragment 0
  UNPARTITIONED
  TOP-N
  ORDER BY: <slot 4> ASC
  LIMIT: 4
  TUPLE IDS: 1 
    AGGREGATE
    OUTPUT: SUM(float_col)
    GROUP BY: int_col
    TUPLE IDS: 1 
      SCAN HBASE table=hbasealltypessmall (0)
        PREDICATES: id < 5
        TUPLE IDS: 0 
---- DISTRIBUTEDPLAN
Plan Fragment 0
  UNPARTITIONED
  TOP-N
  ORDER BY: <slot 4> ASC
  LIMIT: 4
  TUPLE IDS: 1 
    AGGREGATE
    OUTPUT: SUM(<slot 4>)
    GROUP BY: <slot 3>
    TUPLE IDS: 1 
      EXCHANGE (3)
        TUPLE IDS: 1 

Plan Fragment 1
  RANDOM
  STREAM DATA SINK
    EXCHANGE ID: 3
    UNPARTITIONED

  AGGREGATE
  OUTPUT: SUM(float_col)
  GROUP BY: int_col
  TUPLE IDS: 1 
    SCAN HBASE table=hbasealltypessmall (0)
      PREDICATES: id < 5
      TUPLE IDS: 0 
---- SCANRANGELOCATIONS
NODE 0:
  HBASE KEYRANGE <unbounded>:<unbounded>
  LOCATIONS:
====
select int_col, sum(float_col), min(float_col) 
from functional.hbasealltypessmall
group by 1
order by 2,3 desc
limit 0
---- PLAN
Plan Fragment 0
  UNPARTITIONED
  TOP-N
  ORDER BY: <slot 3> ASC, <slot 4> DESC
  LIMIT: 0
  TUPLE IDS: 1 
    AGGREGATE
    OUTPUT: SUM(float_col), MIN(float_col)
    GROUP BY: int_col
    TUPLE IDS: 1 
      SCAN HBASE table=hbasealltypessmall (0)
        TUPLE IDS: 0 
---- DISTRIBUTEDPLAN
Plan Fragment 0
  UNPARTITIONED
  TOP-N
  ORDER BY: <slot 3> ASC, <slot 4> DESC
  LIMIT: 0
  TUPLE IDS: 1 
    AGGREGATE
    OUTPUT: SUM(<slot 3>), MIN(<slot 4>)
    GROUP BY: <slot 2>
    TUPLE IDS: 1 
      EXCHANGE (3)
        TUPLE IDS: 1 

Plan Fragment 1
  RANDOM
  STREAM DATA SINK
    EXCHANGE ID: 3
    UNPARTITIONED

  AGGREGATE
  OUTPUT: SUM(float_col), MIN(float_col)
  GROUP BY: int_col
  TUPLE IDS: 1 
    SCAN HBASE table=hbasealltypessmall (0)
      TUPLE IDS: 0 
---- SCANRANGELOCATIONS
NODE 0:
  HBASE KEYRANGE <unbounded>:<unbounded>
  LOCATIONS:
====
