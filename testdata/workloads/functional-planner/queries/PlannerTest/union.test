// Only UNION ALL, no nested unions
select * from functional.alltypestiny where year=2009 and month=1
union all
select * from functional.alltypestiny where year=2009 and month=1
union all
select * from functional.alltypestiny where year=2009 and month=2
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:MERGE
  |  cardinality: 6
  |  per-host memory: unavailable
  |  tuple ids: 3
  |
  |----2:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  |----3:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 2
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=2.81GB VCores=3

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  4:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 3

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 4
    UNPARTITIONED

  7:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 3
  |
  3:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 2

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 4
    UNPARTITIONED

  6:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 3
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 3
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 4
    UNPARTITIONED

  5:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 3
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 1:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 2:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 3:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
====
// Only UNION ALL with limit inside operands. One of the operands also has an order by.
select * from functional.alltypestiny where year=2009 and month=1 limit 1
union all
select * from functional.alltypestiny where year=2009 and month=1 order by int_col limit 1
union all
select * from functional.alltypestiny where year=2009 and month=2 limit 1
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:MERGE
  |  cardinality: 5
  |  per-host memory: unavailable
  |  tuple ids: 3
  |
  |----3:TOP-N
  |    |  order by: int_col ASC
  |    |  limit: 1
  |    |  cardinality: 1
  |    |  per-host memory: unavailable
  |    |  tuple ids: 1
  |    |
  |    2:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  |----4:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       limit: 1
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 2
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     limit: 1
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1.88GB VCores=2

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  9:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 3

PLAN FRAGMENT 1
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 9
    UNPARTITIONED

  12:MERGE
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 3
  |
  8:EXCHANGE
     limit: 1
     cardinality: 1
     per-host memory: unavailable
     tuple ids: 2

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 8
    UNPARTITIONED

  4:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     limit: 1
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 2

PLAN FRAGMENT 3
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 9
    UNPARTITIONED

  11:MERGE
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 3
  |
  7:TOP-N
  |  order by: int_col ASC
  |  limit: 1
  |  cardinality: 1
  |  per-host memory: unavailable
  |  tuple ids: 1
  |
  6:EXCHANGE
     cardinality: 1
     per-host memory: unavailable
     tuple ids: 1

PLAN FRAGMENT 4
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 6
    UNPARTITIONED

  3:TOP-N
  |  order by: int_col ASC
  |  limit: 1
  |  cardinality: 1
  |  per-host memory: 97B
  |  tuple ids: 1
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 5
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 9
    UNPARTITIONED

  10:MERGE
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 3
  |
  5:EXCHANGE
     limit: 1
     cardinality: 1
     per-host memory: unavailable
     tuple ids: 0

PLAN FRAGMENT 6
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 5
    UNPARTITIONED

  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     limit: 1
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 1:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 2:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 4:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
====
// Only UNION DISTINCT, no nested unions
select * from functional.alltypestiny where year=2009 and month=1
union distinct
select * from functional.alltypestiny where year=2009 and month=1
union distinct
select * from functional.alltypestiny where year=2009 and month=2
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  4:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 3
  |
  0:MERGE
  |  cardinality: 6
  |  per-host memory: unavailable
  |  tuple ids: 3
  |
  |----2:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  |----3:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 2
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=2.81GB VCores=3

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  4:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 3
  |
  5:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 3

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 5
    UNPARTITIONED

  8:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 3
  |
  3:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 2

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 5
    UNPARTITIONED

  7:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 3
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 3
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 5
    UNPARTITIONED

  6:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 3
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 1:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 2:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 3:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
====
// Only UNION ALL, mixed selects with and without from clauses, no nested unions
select * from functional.alltypestiny where year=2009 and month=1
union all
select 0,true,0,0,0,0,0,0,'01/01/09','0',cast('2009-01-01 00:00:00' as timestamp),2009,1
union all
select * from functional.alltypestiny where year=2009 and month=1
union all
select 1,false,1,1,1,10,1.1,10.1,'01/01/09','1',cast('2009-01-01 00:01:00' as timestamp),2009,1
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:MERGE
  |  merging 2 SELECT CONSTANT
  |  cardinality: 6
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  |----2:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1.88GB VCores=2

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  3:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 2

PLAN FRAGMENT 1
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 3
    UNPARTITIONED

  6:MERGE
     merging 2 SELECT CONSTANT
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 2

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 3
    UNPARTITIONED

  5:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 2
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 3
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 3
    UNPARTITIONED

  4:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 2
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 1:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 2:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
====
// Only UNION DISTINCT, mixed selects with and without from clauses, no nested unions
select * from functional.alltypestiny where year=2009 and month=1
union distinct
select 0,true,0,0,0,0,0,0,'01/01/09','0',cast('2009-01-01 00:00:00' as timestamp),2009,1
union distinct
select * from functional.alltypestiny where year=2009 and month=1
union distinct
select 1,false,1,1,1,10,1.1,10.1,'01/01/09','1',cast('2009-01-01 00:01:00' as timestamp),2009,1
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  3:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  0:MERGE
  |  merging 2 SELECT CONSTANT
  |  cardinality: 6
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  |----2:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1.88GB VCores=2

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  3:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  4:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 2

PLAN FRAGMENT 1
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 4
    UNPARTITIONED

  7:MERGE
     merging 2 SELECT CONSTANT
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 2

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 4
    UNPARTITIONED

  6:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 2
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 3
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 4
    UNPARTITIONED

  5:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 2
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 1:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 2:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
====
// Mixed UNION ALL/DISTINCT but effectively only UNION DISTINCT, no nested unions,
// with order by and limit
select * from functional.alltypestiny where year=2009 and month=1
union all
select * from functional.alltypestiny where year=2009 and month=1
union all
select * from functional.alltypestiny where year=2009 and month=2
union distinct
(select * from functional.alltypestiny where year=2009 and month=2)
order by 3 limit 3
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  6:TOP-N
  |  order by: tinyint_col ASC
  |  limit: 3
  |  cardinality: 3
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  5:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  0:MERGE
  |  cardinality: 8
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  |----2:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  |----3:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 2
  |
  |----4:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 3
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=3.75GB VCores=4

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  6:TOP-N
  |  order by: tinyint_col ASC
  |  limit: 3
  |  cardinality: 3
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  5:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  7:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 4

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 7
    UNPARTITIONED

  11:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  4:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 3

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 7
    UNPARTITIONED

  10:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  3:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 2

PLAN FRAGMENT 3
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 7
    UNPARTITIONED

  9:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 4
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 7
    UNPARTITIONED

  8:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 1:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 2:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 3:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
NODE 4:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
====
// Mixed UNION ALL/DISTINCT, no nested unions, with order by and limit
select * from functional.alltypestiny where year=2009 and month=1
union distinct
select * from functional.alltypestiny where year=2009 and month=1
union all
select * from functional.alltypestiny where year=2009 and month=2
union all
(select * from functional.alltypestiny where year=2009 and month=2)
order by 3,4 limit 3
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  7:TOP-N
  |  order by: tinyint_col ASC, smallint_col ASC
  |  limit: 3
  |  cardinality: 3
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  4:MERGE
  |  cardinality: 4
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  |----5:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 2
  |
  |----6:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 3
  |
  3:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  0:MERGE
  |  cardinality: 4
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  |----2:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1.88GB VCores=2

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  7:TOP-N
  |  order by: tinyint_col ASC, smallint_col ASC
  |  limit: 3
  |  cardinality: 3
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  11:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 4

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 11
    UNPARTITIONED

  14:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  6:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 3

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 11
    UNPARTITIONED

  13:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  5:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 2

PLAN FRAGMENT 3
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 11
    UNPARTITIONED

  12:MERGE
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  3:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  8:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 4

PLAN FRAGMENT 4
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 8
    UNPARTITIONED

  10:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 5
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 8
    UNPARTITIONED

  9:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 1:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 2:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 5:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
NODE 6:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
====
// Mixed UNION ALL/DISTINCT, no nested unions, with order by and limit
select * from functional.alltypestiny where year=2009 and month=1
union all
select * from functional.alltypestiny where year=2009 and month=1
union distinct
select * from functional.alltypestiny where year=2009 and month=2
union all
(select * from functional.alltypestiny where year=2009 and month=2)
order by 3,4 limit 4
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  7:TOP-N
  |  order by: tinyint_col ASC, smallint_col ASC
  |  limit: 4
  |  cardinality: 2
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  5:MERGE
  |  cardinality: 2
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  |----6:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 3
  |
  4:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  0:MERGE
  |  cardinality: 6
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  |----2:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  |----3:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 2
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=2.81GB VCores=3

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  7:TOP-N
  |  order by: tinyint_col ASC, smallint_col ASC
  |  limit: 4
  |  cardinality: 2
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  12:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 4

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 12
    UNPARTITIONED

  14:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  6:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 3

PLAN FRAGMENT 2
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 12
    UNPARTITIONED

  13:MERGE
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  4:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  8:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 4

PLAN FRAGMENT 3
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 8
    UNPARTITIONED

  11:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  3:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 2

PLAN FRAGMENT 4
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 8
    UNPARTITIONED

  10:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 5
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 8
    UNPARTITIONED

  9:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 1:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 2:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 3:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
NODE 6:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
====
// Union unnesting: Only UNION ALL, first operand is nested
(select * from functional.alltypestiny where year=2009 and month=1
 union all
 select * from functional.alltypestiny where year=2009 and month=2)
union all
select * from functional.alltypestiny where year=2009 and month=1
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:MERGE
  |  cardinality: 6
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  |----2:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  |----3:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 3
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=2.81GB VCores=3

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  4:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 4

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 4
    UNPARTITIONED

  7:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  3:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 3

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 4
    UNPARTITIONED

  6:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 3
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 4
    UNPARTITIONED

  5:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 1:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 2:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
NODE 3:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
====
// Union unnesting: Only UNION ALL, second operand is nested
select * from functional.alltypestiny where year=2009 and month=1
union all
  (select * from functional.alltypestiny where year=2009 and month=1
   union all
   select * from functional.alltypestiny where year=2009 and month=2)
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:MERGE
  |  cardinality: 6
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  |----2:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  |----3:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 2
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=2.81GB VCores=3

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  4:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 4

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 4
    UNPARTITIONED

  7:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  3:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 2

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 4
    UNPARTITIONED

  6:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 3
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 4
    UNPARTITIONED

  5:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 1:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 2:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 3:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
====
// Union unnesting: Only UNION DISTINCT, first operand is nested
(select * from functional.alltypestiny where year=2009 and month=1
 union distinct
 select * from functional.alltypestiny where year=2009 and month=2)
union distinct
select * from functional.alltypestiny where year=2009 and month=1
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  4:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  0:MERGE
  |  cardinality: 6
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  |----2:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  |----3:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 3
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=2.81GB VCores=3

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  4:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  5:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 4

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 5
    UNPARTITIONED

  8:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  3:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 3

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 5
    UNPARTITIONED

  7:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 3
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 5
    UNPARTITIONED

  6:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 1:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 2:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
NODE 3:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
====
// Union unnesting: Only UNION DISTINCT, second operand is nested
select * from functional.alltypestiny where year=2009 and month=1
union distinct
  (select * from functional.alltypestiny where year=2009 and month=1
   union distinct
   select * from functional.alltypestiny where year=2009 and month=2)
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  4:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  0:MERGE
  |  cardinality: 6
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  |----2:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  |----3:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 2
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=2.81GB VCores=3

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  4:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  5:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 4

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 5
    UNPARTITIONED

  8:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  3:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 2

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 5
    UNPARTITIONED

  7:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 3
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 5
    UNPARTITIONED

  6:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 1:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 2:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 3:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
====
// Union unnesting: UNION ALL doesn't absorb nested union with DISTINCT,
// first operand is nested
(select * from functional.alltypestiny where year=2009 and month=1
 union distinct
 select * from functional.alltypestiny where year=2009 and month=2)
union all
select * from functional.alltypestiny where year=2009 and month=1
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:MERGE
  |  cardinality: 2
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  |----5:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 3
  |
  4:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  1:MERGE
  |  cardinality: 4
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  |----3:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1.88GB VCores=2

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  9:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 4

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 9
    UNPARTITIONED

  11:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  5:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 3

PLAN FRAGMENT 2
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 9
    UNPARTITIONED

  10:MERGE
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  4:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  6:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 2

PLAN FRAGMENT 3
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 6
    UNPARTITIONED

  8:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 2
  |
  3:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 4
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 6
    UNPARTITIONED

  7:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 2
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 2:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 3:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
NODE 5:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
====
// Union unnesting: UNION ALL doesn't absorb nested union with DISTINCT,
// second operand is nested
select * from functional.alltypestiny where year=2009 and month=1
union all
  (select * from functional.alltypestiny where year=2009 and month=1
   union distinct
   select * from functional.alltypestiny where year=2009 and month=2)
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:MERGE
  |  cardinality: 2
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  |----5:AGGREGATE (finalize)
  |    |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |    |  cardinality: unavailable
  |    |  per-host memory: unavailable
  |    |  tuple ids: 3
  |    |
  |    2:MERGE
  |    |  cardinality: 4
  |    |  per-host memory: unavailable
  |    |  tuple ids: 3
  |    |
  |    |----4:SCAN HDFS
  |    |       table=functional.alltypestiny #partitions=1/4 size=115B
  |    |       table stats: 8 rows total
  |    |       columns missing stats: timestamp_col
  |    |       cardinality: 2
  |    |       per-host memory: unavailable
  |    |       tuple ids: 2
  |    |
  |    3:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1.88GB VCores=2

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  9:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 4

PLAN FRAGMENT 1
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 9
    UNPARTITIONED

  11:MERGE
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  5:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 3
  |
  6:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 3

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 6
    UNPARTITIONED

  8:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 3
  |
  4:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 2

PLAN FRAGMENT 3
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 6
    UNPARTITIONED

  7:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 3
  |
  3:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 4
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 9
    UNPARTITIONED

  10:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 1:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 3:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 4:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
====
// Union unnesting: UNION ALL absorbs the children but not directly the operands
// of a nested union with mixed ALL/DISTINCT, first operand is nested
(select * from functional.alltypestiny where year=2009 and month=1
 union distinct
 select * from functional.alltypestiny where year=2009 and month=2
 union all
 select * from functional.alltypestiny where year=2009 and month=2)
union all
select * from functional.alltypestiny where year=2009 and month=1
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:MERGE
  |  cardinality: 4
  |  per-host memory: unavailable
  |  tuple ids: 5
  |
  |----6:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 2
  |
  |----7:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 4
  |
  4:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 3
  |
  1:MERGE
  |  cardinality: 4
  |  per-host memory: unavailable
  |  tuple ids: 3
  |
  |----3:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1.88GB VCores=2

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  11:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 5

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 11
    UNPARTITIONED

  14:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 5
  |
  7:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 4

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 11
    UNPARTITIONED

  13:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 5
  |
  6:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 2

PLAN FRAGMENT 3
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 11
    UNPARTITIONED

  12:MERGE
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 5
  |
  4:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 3
  |
  8:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 3

PLAN FRAGMENT 4
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 8
    UNPARTITIONED

  10:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 3
  |
  3:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 5
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 8
    UNPARTITIONED

  9:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 3
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 2:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 3:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
NODE 6:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
NODE 7:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
====
// Union unnesting: UNION ALL absorbs the children but not directly the operands
// of a nested union with mixed ALL/DISTINCT, second operand is nested
select * from functional.alltypestiny where year=2009 and month=1
union all
  (select * from functional.alltypestiny where year=2009 and month=1
   union distinct
   select * from functional.alltypestiny where year=2009 and month=2
   union all
   select * from functional.alltypestiny where year=2009 and month=2)
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:MERGE
  |  cardinality: 4
  |  per-host memory: unavailable
  |  tuple ids: 5
  |
  |----5:AGGREGATE (finalize)
  |    |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |    |  cardinality: unavailable
  |    |  per-host memory: unavailable
  |    |  tuple ids: 4
  |    |
  |    2:MERGE
  |    |  cardinality: 4
  |    |  per-host memory: unavailable
  |    |  tuple ids: 4
  |    |
  |    |----4:SCAN HDFS
  |    |       table=functional.alltypestiny #partitions=1/4 size=115B
  |    |       table stats: 8 rows total
  |    |       columns missing stats: timestamp_col
  |    |       cardinality: 2
  |    |       per-host memory: unavailable
  |    |       tuple ids: 2
  |    |
  |    3:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  |----7:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 3
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1.88GB VCores=2

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  11:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 5

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 11
    UNPARTITIONED

  14:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 5
  |
  7:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 3

PLAN FRAGMENT 2
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 11
    UNPARTITIONED

  13:MERGE
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 5
  |
  5:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  8:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 4

PLAN FRAGMENT 3
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 8
    UNPARTITIONED

  10:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  4:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 2

PLAN FRAGMENT 4
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 8
    UNPARTITIONED

  9:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  3:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 5
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 11
    UNPARTITIONED

  12:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 5
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 1:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 3:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 4:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
NODE 7:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
====
// Union unnesting: UNION ALL doesn't absorb the children of a nested union
// with mixed ALL/DISTINCT and limit, second operand is nested
select * from functional.alltypestiny where year=2009 and month=1
union all
  (select * from functional.alltypestiny where year=2009 and month=1
   union distinct
   select * from functional.alltypestiny where year=2009 and month=2
   union all
   (select * from functional.alltypestiny where year=2009 and month=2)
   limit 10)
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:MERGE
  |  cardinality: 4
  |  per-host memory: unavailable
  |  tuple ids: 5
  |
  |----6:MERGE
  |    |  limit: 10
  |    |  cardinality: 2
  |    |  per-host memory: unavailable
  |    |  tuple ids: 4
  |    |
  |    |----7:SCAN HDFS
  |    |       table=functional.alltypestiny #partitions=1/4 size=115B
  |    |       table stats: 8 rows total
  |    |       columns missing stats: timestamp_col
  |    |       cardinality: 2
  |    |       per-host memory: unavailable
  |    |       tuple ids: 3
  |    |
  |    5:AGGREGATE (finalize)
  |    |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |    |  cardinality: unavailable
  |    |  per-host memory: unavailable
  |    |  tuple ids: 4
  |    |
  |    2:MERGE
  |    |  cardinality: 4
  |    |  per-host memory: unavailable
  |    |  tuple ids: 4
  |    |
  |    |----4:SCAN HDFS
  |    |       table=functional.alltypestiny #partitions=1/4 size=115B
  |    |       table stats: 8 rows total
  |    |       columns missing stats: timestamp_col
  |    |       cardinality: 2
  |    |       per-host memory: unavailable
  |    |       tuple ids: 2
  |    |
  |    3:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1.88GB VCores=2

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  14:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 5

PLAN FRAGMENT 1
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 14
    UNPARTITIONED

  16:MERGE
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 5
  |
  11:EXCHANGE
     limit: 10
     cardinality: 10
     per-host memory: unavailable
     tuple ids: 4

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 11
    UNPARTITIONED

  13:MERGE
  |  limit: 10
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  7:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 3

PLAN FRAGMENT 3
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 11
    UNPARTITIONED

  12:MERGE
  |  limit: 10
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  5:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  8:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 4

PLAN FRAGMENT 4
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 8
    UNPARTITIONED

  10:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  4:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 2

PLAN FRAGMENT 5
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 8
    UNPARTITIONED

  9:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  3:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 6
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 14
    UNPARTITIONED

  15:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 5
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 1:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 3:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 4:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
NODE 7:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
====
// Union unnesting: UNION ALL doesn't absorb nested union with order by and limit,
// first operand is nested
(select * from functional.alltypestiny where year=2009 and month=1
 union all
 (select * from functional.alltypestiny where year=2009 and month=2)
 order by 3 limit 3)
union all
select * from functional.alltypestiny where year=2009 and month=1
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:MERGE
  |  cardinality: 5
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  |----5:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 3
  |
  4:TOP-N
  |  order by: tinyint_col ASC
  |  limit: 3
  |  cardinality: 3
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  1:MERGE
  |  cardinality: 4
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  |----3:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1.88GB VCores=2

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  9:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 4

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 9
    UNPARTITIONED

  11:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  5:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 3

PLAN FRAGMENT 2
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 9
    UNPARTITIONED

  10:MERGE
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  4:TOP-N
  |  order by: tinyint_col ASC
  |  limit: 3
  |  cardinality: 3
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  6:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 2

PLAN FRAGMENT 3
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 6
    UNPARTITIONED

  8:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 2
  |
  3:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 4
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 6
    UNPARTITIONED

  7:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 2
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 2:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 3:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
NODE 5:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
====
// Union unnesting: UNION ALL doesn't absorb nested union with order by and limit,
// second operand is nested
select * from functional.alltypestiny where year=2009 and month=1
union all
  (select * from functional.alltypestiny where year=2009 and month=1
   union all
   (select * from functional.alltypestiny where year=2009 and month=2)
   order by 3 limit 3)
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:MERGE
  |  cardinality: 5
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  |----5:TOP-N
  |    |  order by: tinyint_col ASC
  |    |  limit: 3
  |    |  cardinality: 3
  |    |  per-host memory: unavailable
  |    |  tuple ids: 3
  |    |
  |    2:MERGE
  |    |  cardinality: 4
  |    |  per-host memory: unavailable
  |    |  tuple ids: 3
  |    |
  |    |----4:SCAN HDFS
  |    |       table=functional.alltypestiny #partitions=1/4 size=115B
  |    |       table stats: 8 rows total
  |    |       columns missing stats: timestamp_col
  |    |       cardinality: 2
  |    |       per-host memory: unavailable
  |    |       tuple ids: 2
  |    |
  |    3:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1.88GB VCores=2

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  9:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 4

PLAN FRAGMENT 1
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 9
    UNPARTITIONED

  11:MERGE
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  5:TOP-N
  |  order by: tinyint_col ASC
  |  limit: 3
  |  cardinality: 3
  |  per-host memory: unavailable
  |  tuple ids: 3
  |
  6:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 3

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 6
    UNPARTITIONED

  8:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 3
  |
  4:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 2

PLAN FRAGMENT 3
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 6
    UNPARTITIONED

  7:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 3
  |
  3:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 4
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 9
    UNPARTITIONED

  10:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 1:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 3:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 4:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
====
// Union unnesting: UNION DISTINCT absorbs nested union with ALL
// first operand is nested
(select * from functional.alltypestiny where year=2009 and month=1
 union all
 select * from functional.alltypestiny where year=2009 and month=2)
union distinct
select * from functional.alltypestiny where year=2009 and month=1
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  4:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  0:MERGE
  |  cardinality: 6
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  |----2:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  |----3:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 3
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=2.81GB VCores=3

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  4:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  5:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 4

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 5
    UNPARTITIONED

  8:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  3:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 3

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 5
    UNPARTITIONED

  7:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 3
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 5
    UNPARTITIONED

  6:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 1:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 2:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
NODE 3:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
====
// Union unnesting: UNION DISTINCT absorbs nested union with ALL,
// second operand is nested
select * from functional.alltypestiny where year=2009 and month=1
union distinct
  (select * from functional.alltypestiny where year=2009 and month=1
   union all
   select * from functional.alltypestiny where year=2009 and month=2)
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  4:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  0:MERGE
  |  cardinality: 6
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  |----2:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  |----3:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 2
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=2.81GB VCores=3

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  4:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  5:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 4

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 5
    UNPARTITIONED

  8:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  3:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 2

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 5
    UNPARTITIONED

  7:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 3
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 5
    UNPARTITIONED

  6:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 1:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 2:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 3:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
====
// Union unnesting: UNION DISTINCT absorbs nested union with mixed ALL/DISTINCT,
// first operand is nested
(select * from functional.alltypestiny where year=2009 and month=1
 union distinct
 select * from functional.alltypestiny where year=2009 and month=2
 union all
 select * from functional.alltypestiny where year=2009 and month=2)
union distinct
select * from functional.alltypestiny where year=2009 and month=1
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  5:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 5
  |
  0:MERGE
  |  cardinality: 8
  |  per-host memory: unavailable
  |  tuple ids: 5
  |
  |----2:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  |----3:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 2
  |
  |----4:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 4
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=3.75GB VCores=4

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  5:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 5
  |
  6:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 5

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 6
    UNPARTITIONED

  10:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 5
  |
  4:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 4

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 6
    UNPARTITIONED

  9:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 5
  |
  3:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 2

PLAN FRAGMENT 3
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 6
    UNPARTITIONED

  8:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 5
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 4
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 6
    UNPARTITIONED

  7:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 5
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 1:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 2:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
NODE 3:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
NODE 4:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
====
// Union unnesting: UNION DISTINCT absorbs nested union with mixed ALL/DISTINCT,
// second operand is nested
select * from functional.alltypestiny where year=2009 and month=1
union distinct
  (select * from functional.alltypestiny where year=2009 and month=1
   union distinct
   select * from functional.alltypestiny where year=2009 and month=2
   union all
   select * from functional.alltypestiny where year=2009 and month=2)
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  5:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 5
  |
  0:MERGE
  |  cardinality: 8
  |  per-host memory: unavailable
  |  tuple ids: 5
  |
  |----2:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  |----3:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 2
  |
  |----4:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 3
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=3.75GB VCores=4

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  5:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 5
  |
  6:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 5

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 6
    UNPARTITIONED

  10:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 5
  |
  4:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 3

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 6
    UNPARTITIONED

  9:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 5
  |
  3:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 2

PLAN FRAGMENT 3
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 6
    UNPARTITIONED

  8:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 5
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 4
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 6
    UNPARTITIONED

  7:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 5
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 1:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 2:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 3:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
NODE 4:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
====
// Union unnesting: UNION DISTINCT doesn't absorb nested union with order by and limit,
// first operand is nested
(select * from functional.alltypestiny where year=2009 and month=1
 union all
 (select * from functional.alltypestiny where year=2009 and month=2)
 order by 3 limit 3)
union distinct
select * from functional.alltypestiny where year=2009 and month=1
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  6:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  0:MERGE
  |  cardinality: 5
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  |----5:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 3
  |
  4:TOP-N
  |  order by: tinyint_col ASC
  |  limit: 3
  |  cardinality: 3
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  1:MERGE
  |  cardinality: 4
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  |----3:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1.88GB VCores=2

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  6:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  10:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 4

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 10
    UNPARTITIONED

  12:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  5:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 3

PLAN FRAGMENT 2
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 10
    UNPARTITIONED

  11:MERGE
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  4:TOP-N
  |  order by: tinyint_col ASC
  |  limit: 3
  |  cardinality: 3
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  7:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 2

PLAN FRAGMENT 3
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 7
    UNPARTITIONED

  9:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 2
  |
  3:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 4
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 7
    UNPARTITIONED

  8:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 2
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 2:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 3:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
NODE 5:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
====
// Union unnesting: UNION DISTINCT doesn't absorb nested union with order by and limit
// second operand is nested
select * from functional.alltypestiny where year=2009 and month=1
union distinct
  (select * from functional.alltypestiny where year=2009 and month=1
   union all
   (select * from functional.alltypestiny where year=2009 and month=2)
   order by 3 limit 3)
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  6:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  0:MERGE
  |  cardinality: 5
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  |----5:TOP-N
  |    |  order by: tinyint_col ASC
  |    |  limit: 3
  |    |  cardinality: 3
  |    |  per-host memory: unavailable
  |    |  tuple ids: 3
  |    |
  |    2:MERGE
  |    |  cardinality: 4
  |    |  per-host memory: unavailable
  |    |  tuple ids: 3
  |    |
  |    |----4:SCAN HDFS
  |    |       table=functional.alltypestiny #partitions=1/4 size=115B
  |    |       table stats: 8 rows total
  |    |       columns missing stats: timestamp_col
  |    |       cardinality: 2
  |    |       per-host memory: unavailable
  |    |       tuple ids: 2
  |    |
  |    3:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1.88GB VCores=2

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  6:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  10:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 4

PLAN FRAGMENT 1
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 10
    UNPARTITIONED

  12:MERGE
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  5:TOP-N
  |  order by: tinyint_col ASC
  |  limit: 3
  |  cardinality: 3
  |  per-host memory: unavailable
  |  tuple ids: 3
  |
  7:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 3

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 7
    UNPARTITIONED

  9:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 3
  |
  4:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 2

PLAN FRAGMENT 3
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 7
    UNPARTITIONED

  8:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 3
  |
  3:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 4
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 10
    UNPARTITIONED

  11:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 1:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 3:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 4:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
====
// Complex union unnesting: Multiple levels of UNION ALL, fully unnestable
select * from functional.alltypestiny where year=2009 and month=1
union all
  (select * from functional.alltypestiny where year=2009 and month=1
   union all
     (select * from functional.alltypestiny where year=2009 and month=2
      union all
        (select * from functional.alltypestiny where year=2009 and month=2
         union all
         select * from functional.alltypestiny where year=2009 and month=3)))
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:MERGE
  |  cardinality: 10
  |  per-host memory: unavailable
  |  tuple ids: 8
  |
  |----2:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  |----3:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 2
  |
  |----4:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 3
  |
  |----5:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 4
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=4.69GB VCores=5

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  6:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 8

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 6
    UNPARTITIONED

  11:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 8
  |
  5:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 4

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 6
    UNPARTITIONED

  10:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 8
  |
  4:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 3

PLAN FRAGMENT 3
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 6
    UNPARTITIONED

  9:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 8
  |
  3:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 2

PLAN FRAGMENT 4
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 6
    UNPARTITIONED

  8:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 8
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 5
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 6
    UNPARTITIONED

  7:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 8
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 1:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 2:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 3:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
NODE 4:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
NODE 5:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=3/090301.txt 0:115
====
// Complex union unnesting: Multiple levels of UNION DISTINCT, fully unnestable
select * from functional.alltypestiny where year=2009 and month=1
union distinct
  (select * from functional.alltypestiny where year=2009 and month=1
   union distinct
     (select * from functional.alltypestiny where year=2009 and month=2
      union distinct
        (select * from functional.alltypestiny where year=2009 and month=2
         union distinct
         select * from functional.alltypestiny where year=2009 and month=3)))
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  6:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 8
  |
  0:MERGE
  |  cardinality: 10
  |  per-host memory: unavailable
  |  tuple ids: 8
  |
  |----2:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  |----3:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 2
  |
  |----4:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 3
  |
  |----5:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 4
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=4.69GB VCores=5

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  6:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 8
  |
  7:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 8

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 7
    UNPARTITIONED

  12:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 8
  |
  5:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 4

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 7
    UNPARTITIONED

  11:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 8
  |
  4:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 3

PLAN FRAGMENT 3
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 7
    UNPARTITIONED

  10:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 8
  |
  3:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 2

PLAN FRAGMENT 4
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 7
    UNPARTITIONED

  9:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 8
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 5
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 7
    UNPARTITIONED

  8:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 8
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 1:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 2:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 3:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
NODE 4:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
NODE 5:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=3/090301.txt 0:115
====
// Complex union unnesting: Partially unnestable up to 2nd level
select * from functional.alltypestiny where year=2009 and month=1
union all
  (select * from functional.alltypestiny where year=2009 and month=1
   union distinct
     (select * from functional.alltypestiny where year=2009 and month=2
      union all
        (select * from functional.alltypestiny where year=2009 and month=2
         union distinct
         (select * from functional.alltypestiny where year=2009 and month=3)
         order by 3 limit 3)))
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:MERGE
  |  cardinality: 2
  |  per-host memory: unavailable
  |  tuple ids: 8
  |
  |----10:AGGREGATE (finalize)
  |    |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |    |  cardinality: unavailable
  |    |  per-host memory: unavailable
  |    |  tuple ids: 7
  |    |
  |    2:MERGE
  |    |  cardinality: 7
  |    |  per-host memory: unavailable
  |    |  tuple ids: 7
  |    |
  |    |----4:SCAN HDFS
  |    |       table=functional.alltypestiny #partitions=1/4 size=115B
  |    |       table stats: 8 rows total
  |    |       columns missing stats: timestamp_col
  |    |       cardinality: 2
  |    |       per-host memory: unavailable
  |    |       tuple ids: 2
  |    |
  |    |----9:TOP-N
  |    |    |  order by: tinyint_col ASC
  |    |    |  limit: 3
  |    |    |  cardinality: 3
  |    |    |  per-host memory: unavailable
  |    |    |  tuple ids: 5
  |    |    |
  |    |    8:AGGREGATE (finalize)
  |    |    |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |    |    |  cardinality: unavailable
  |    |    |  per-host memory: unavailable
  |    |    |  tuple ids: 5
  |    |    |
  |    |    5:MERGE
  |    |    |  cardinality: 4
  |    |    |  per-host memory: unavailable
  |    |    |  tuple ids: 5
  |    |    |
  |    |    |----7:SCAN HDFS
  |    |    |       table=functional.alltypestiny #partitions=1/4 size=115B
  |    |    |       table stats: 8 rows total
  |    |    |       columns missing stats: timestamp_col
  |    |    |       cardinality: 2
  |    |    |       per-host memory: unavailable
  |    |    |       tuple ids: 4
  |    |    |
  |    |    6:SCAN HDFS
  |    |       table=functional.alltypestiny #partitions=1/4 size=115B
  |    |       table stats: 8 rows total
  |    |       columns missing stats: timestamp_col
  |    |       cardinality: 2
  |    |       per-host memory: unavailable
  |    |       tuple ids: 3
  |    |
  |    3:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1.88GB VCores=2

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  18:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 8

PLAN FRAGMENT 1
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 18
    UNPARTITIONED

  20:MERGE
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 8
  |
  10:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 7
  |
  14:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 7

PLAN FRAGMENT 2
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 14
    UNPARTITIONED

  17:MERGE
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 7
  |
  9:TOP-N
  |  order by: tinyint_col ASC
  |  limit: 3
  |  cardinality: 3
  |  per-host memory: unavailable
  |  tuple ids: 5
  |
  8:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 5
  |
  11:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 5

PLAN FRAGMENT 3
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 11
    UNPARTITIONED

  13:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 5
  |
  7:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 4

PLAN FRAGMENT 4
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 11
    UNPARTITIONED

  12:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 5
  |
  6:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 3

PLAN FRAGMENT 5
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 14
    UNPARTITIONED

  16:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 7
  |
  4:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 2

PLAN FRAGMENT 6
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 14
    UNPARTITIONED

  15:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 7
  |
  3:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 7
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 18
    UNPARTITIONED

  19:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 8
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 1:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 3:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 4:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
NODE 6:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
NODE 7:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=3/090301.txt 0:115
====
// Complex union unnesting: Partially unnestable up to 1st level
select * from functional.alltypestiny where year=2009 and month=1
union distinct
  (select * from functional.alltypestiny where year=2009 and month=1
   union distinct
     (select * from functional.alltypestiny where year=2009 and month=2
      union all
        (select * from functional.alltypestiny where year=2009 and month=2
         union distinct
         (select * from functional.alltypestiny where year=2009 and month=3)
         order by 3 limit 3)))
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  9:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 8
  |
  0:MERGE
  |  cardinality: 9
  |  per-host memory: unavailable
  |  tuple ids: 8
  |
  |----2:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  |----3:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 2
  |
  |----8:TOP-N
  |    |  order by: tinyint_col ASC
  |    |  limit: 3
  |    |  cardinality: 3
  |    |  per-host memory: unavailable
  |    |  tuple ids: 5
  |    |
  |    7:AGGREGATE (finalize)
  |    |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |    |  cardinality: unavailable
  |    |  per-host memory: unavailable
  |    |  tuple ids: 5
  |    |
  |    4:MERGE
  |    |  cardinality: 4
  |    |  per-host memory: unavailable
  |    |  tuple ids: 5
  |    |
  |    |----6:SCAN HDFS
  |    |       table=functional.alltypestiny #partitions=1/4 size=115B
  |    |       table stats: 8 rows total
  |    |       columns missing stats: timestamp_col
  |    |       cardinality: 2
  |    |       per-host memory: unavailable
  |    |       tuple ids: 4
  |    |
  |    5:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 3
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=2.81GB VCores=3

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  9:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 8
  |
  13:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 8

PLAN FRAGMENT 1
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 13
    UNPARTITIONED

  17:MERGE
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 8
  |
  8:TOP-N
  |  order by: tinyint_col ASC
  |  limit: 3
  |  cardinality: 3
  |  per-host memory: unavailable
  |  tuple ids: 5
  |
  7:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 5
  |
  10:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 5

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 10
    UNPARTITIONED

  12:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 5
  |
  6:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 4

PLAN FRAGMENT 3
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 10
    UNPARTITIONED

  11:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 5
  |
  5:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 3

PLAN FRAGMENT 4
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 13
    UNPARTITIONED

  16:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 8
  |
  3:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 2

PLAN FRAGMENT 5
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 13
    UNPARTITIONED

  15:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 8
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 6
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 13
    UNPARTITIONED

  14:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 8
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 1:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 2:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 3:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
NODE 5:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
NODE 6:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=3/090301.txt 0:115
====
// Complex union unnesting: Multiple nested unions to test all rules in a single query
select * from functional.alltypestiny where year=2009 and month=1
union distinct
  (select * from functional.alltypestiny where year=2009 and month=1
   union all
   select * from functional.alltypestiny where year=2009 and month=2)
union distinct
  (select * from functional.alltypestiny where year=2009 and month=2
   union all
   (select * from functional.alltypestiny where year=2009 and month=3)
   order by 3 limit 3)
union all
  (select * from functional.alltypestiny where year=2009 and month=3
   union all
   select * from functional.alltypestiny where year=2009 and month=4)
union all
  (select * from functional.alltypestiny where year=2009 and month=4
   union all
   (select * from functional.alltypestiny where year=2009 and month=5)
   order by 3 limit 3)
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  9:MERGE
  |  cardinality: 7
  |  per-host memory: unavailable
  |  tuple ids: 13
  |
  |----10:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 7
  |
  |----11:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 8
  |
  |----15:TOP-N
  |    |  order by: tinyint_col ASC
  |    |  limit: 3
  |    |  cardinality: 3
  |    |  per-host memory: unavailable
  |    |  tuple ids: 12
  |    |
  |    12:MERGE
  |    |  cardinality: 10
  |    |  per-host memory: unavailable
  |    |  tuple ids: 12
  |    |
  |    |----14:SCAN HDFS
  |    |       table=functional.alltypestiny #partitions=0/4 size=0B
  |    |       table stats: 8 rows total
  |    |       columns missing stats: timestamp_col
  |    |       cardinality: 8
  |    |       per-host memory: unavailable
  |    |       tuple ids: 11
  |    |
  |    13:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 10
  |
  8:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 13
  |
  0:MERGE
  |  cardinality: 9
  |  per-host memory: unavailable
  |  tuple ids: 13
  |
  |----2:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  |----3:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 2
  |
  |----7:TOP-N
  |    |  order by: tinyint_col ASC
  |    |  limit: 3
  |    |  cardinality: 3
  |    |  per-host memory: unavailable
  |    |  tuple ids: 6
  |    |
  |    4:MERGE
  |    |  cardinality: 4
  |    |  per-host memory: unavailable
  |    |  tuple ids: 6
  |    |
  |    |----6:SCAN HDFS
  |    |       table=functional.alltypestiny #partitions=1/4 size=115B
  |    |       table stats: 8 rows total
  |    |       columns missing stats: timestamp_col
  |    |       cardinality: 2
  |    |       per-host memory: unavailable
  |    |       tuple ids: 5
  |    |
  |    5:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 4
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=2.81GB VCores=3

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  27:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 13

PLAN FRAGMENT 1
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 27
    UNPARTITIONED

  31:MERGE
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 13
  |
  15:TOP-N
  |  order by: tinyint_col ASC
  |  limit: 3
  |  cardinality: 3
  |  per-host memory: unavailable
  |  tuple ids: 12
  |
  24:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 12

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 24
    UNPARTITIONED

  26:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 12
  |
  14:SCAN HDFS
     table=functional.alltypestiny #partitions=0/4 size=0B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 8
     per-host memory: 960.00MB
     tuple ids: 11

PLAN FRAGMENT 3
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 24
    UNPARTITIONED

  25:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 12
  |
  13:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 10

PLAN FRAGMENT 4
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 27
    UNPARTITIONED

  30:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 13
  |
  11:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 8

PLAN FRAGMENT 5
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 27
    UNPARTITIONED

  29:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 13
  |
  10:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 7

PLAN FRAGMENT 6
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 27
    UNPARTITIONED

  28:MERGE
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 13
  |
  8:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 13
  |
  19:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 13

PLAN FRAGMENT 7
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 19
    UNPARTITIONED

  23:MERGE
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 13
  |
  7:TOP-N
  |  order by: tinyint_col ASC
  |  limit: 3
  |  cardinality: 3
  |  per-host memory: unavailable
  |  tuple ids: 6
  |
  16:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 6

PLAN FRAGMENT 8
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 16
    UNPARTITIONED

  18:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 6
  |
  6:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 5

PLAN FRAGMENT 9
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 16
    UNPARTITIONED

  17:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 6
  |
  5:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 4

PLAN FRAGMENT 10
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 19
    UNPARTITIONED

  22:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 13
  |
  3:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 2

PLAN FRAGMENT 11
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 19
    UNPARTITIONED

  21:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 13
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 12
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 19
    UNPARTITIONED

  20:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 13
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 1:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 2:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 3:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
NODE 5:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
NODE 6:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=3/090301.txt 0:115
NODE 10:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=3/090301.txt 0:115
NODE 11:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=4/090401.txt 0:115
NODE 13:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=4/090401.txt 0:115
NODE 14:
====
// UNION ALL in subquery
select x.* from
  (select * from functional.alltypestiny where year=2009 and month=1
   union all
   select * from functional.alltypestiny where year=2009 and month=1) x
union all
(select * from functional.alltypestiny where year=2009 and month=2)
order by 3 limit 5
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  5:TOP-N
  |  order by: tinyint_col ASC
  |  limit: 5
  |  cardinality: 5
  |  per-host memory: unavailable
  |  tuple ids: 5
  |
  0:MERGE
  |  cardinality: 6
  |  per-host memory: unavailable
  |  tuple ids: 5
  |
  |----4:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 4
  |
  1:MERGE
  |  cardinality: 4
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  |----3:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=2.81GB VCores=3

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  5:TOP-N
  |  order by: tinyint_col ASC
  |  limit: 5
  |  cardinality: 5
  |  per-host memory: unavailable
  |  tuple ids: 5
  |
  9:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 5

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 9
    UNPARTITIONED

  11:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 5
  |
  4:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 4

PLAN FRAGMENT 2
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 9
    UNPARTITIONED

  10:MERGE
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 5
  |
  6:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 2

PLAN FRAGMENT 3
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 6
    UNPARTITIONED

  8:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 2
  |
  3:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 4
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 6
    UNPARTITIONED

  7:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 2
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 2:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 3:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 4:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
====
// UNION DISTINCT in subquery
select x.* from
  (select * from functional.alltypestiny where year=2009 and month=1
   union distinct
   select * from functional.alltypestiny where year=2009 and month=1) x
union distinct
(select * from functional.alltypestiny where year=2009 and month=2)
order by 3 limit 3
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  7:TOP-N
  |  order by: tinyint_col ASC
  |  limit: 3
  |  cardinality: 3
  |  per-host memory: unavailable
  |  tuple ids: 5
  |
  6:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 5
  |
  0:MERGE
  |  cardinality: 2
  |  per-host memory: unavailable
  |  tuple ids: 5
  |
  |----5:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 4
  |
  4:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  1:MERGE
  |  cardinality: 4
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  |----3:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1.88GB VCores=2

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  7:TOP-N
  |  order by: tinyint_col ASC
  |  limit: 3
  |  cardinality: 3
  |  per-host memory: unavailable
  |  tuple ids: 5
  |
  6:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 5
  |
  11:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 5

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 11
    UNPARTITIONED

  13:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 5
  |
  5:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 4

PLAN FRAGMENT 2
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 11
    UNPARTITIONED

  12:MERGE
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 5
  |
  4:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  8:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 2

PLAN FRAGMENT 3
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 8
    UNPARTITIONED

  10:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 2
  |
  3:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 4
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 8
    UNPARTITIONED

  9:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 2
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 2:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 3:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 5:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
====
// UNION ALL in subquery with a WHERE condition in the outer select.
select x.* from
  (select * from functional.alltypestiny where year=2009 and month=1
   union all
   select * from functional.alltypestiny where year=2009 and month=1) x
where x.int_col < 5 and x.bool_col = false
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:MERGE
  |  predicates: int_col < 5, bool_col = FALSE
  |  cardinality: 4
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  |----2:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1.88GB VCores=2

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  3:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 2

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 3
    UNPARTITIONED

  5:MERGE
  |  predicates: int_col < 5, bool_col = FALSE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 2
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 3
    UNPARTITIONED

  4:MERGE
  |  predicates: int_col < 5, bool_col = FALSE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 2
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 1:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 2:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
====
// UNION DISTINCT in subquery with a WHERE condition in the outer select.
select x.* from
  (select * from functional.alltypestiny where year=2009 and month=1
   union distinct
   select * from functional.alltypestiny where year=2009 and month=1) x
where x.int_col < 5 and x.bool_col = false
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  3:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  0:MERGE
  |  predicates: int_col < 5, bool_col = FALSE
  |  cardinality: 4
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  |----2:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       columns missing stats: timestamp_col
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1.88GB VCores=2

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  3:AGGREGATE (finalize)
  |  group by: id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, float_col, double_col, date_string_col, string_col, timestamp_col, year, month
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  4:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 2

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 4
    UNPARTITIONED

  6:MERGE
  |  predicates: int_col < 5, bool_col = FALSE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 2
  |
  2:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 4
    UNPARTITIONED

  5:MERGE
  |  predicates: int_col < 5, bool_col = FALSE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 2
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     columns missing stats: timestamp_col
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 1:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
NODE 2:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
====
// UNION ALL with only constant selects
select 1, 'a', NULL, 10.f
union all
select 2, 'b', NULL, 20.f
union all
select 3, 'c', NULL, 30.f
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:MERGE
     merging 3 SELECT CONSTANT
     cardinality: 3
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:MERGE
     merging 3 SELECT CONSTANT
     cardinality: 3
     per-host memory: unavailable
     tuple ids: 0
====
// UNION DISTINCT with only constant selects
select 1, 'a', NULL, 10.0f
union distinct
select 2, 'b', NULL, 20.0f
union distinct
select 3, 'c', NULL, 30.0f
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  1:AGGREGATE (finalize)
  |  group by: 1, 'a', null, f
  |  cardinality: 0
  |  per-host memory: unavailable
  |  tuple ids: 0
  |
  0:MERGE
     merging 3 SELECT CONSTANT
     cardinality: 3
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  1:AGGREGATE (finalize)
  |  group by: 1, 'a', null, f
  |  cardinality: 0
  |  per-host memory: unavailable
  |  tuple ids: 0
  |
  0:MERGE
     merging 3 SELECT CONSTANT
     cardinality: 3
     per-host memory: unavailable
     tuple ids: 0
====
// UNION ALL/DISTINCT with mixed constant selects and non-constant selects
select 1, 'a', NULL, 10.f
union all
select int_col, string_col, bool_col, float_col from functional.alltypestiny
union distinct
select 3, 'c', NULL, 30.f
union all
select int_col, string_col, bool_col, float_col from functional.alltypestiny
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  3:MERGE
  |  cardinality: 8
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  |----4:SCAN HDFS
  |       table=functional.alltypestiny #partitions=4/4 size=460B
  |       table stats: 8 rows total
  |       column stats: all
  |       cardinality: 8
  |       per-host memory: unavailable
  |       tuple ids: 1
  |
  2:AGGREGATE (finalize)
  |  group by: 1, 'a', null, f
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  0:MERGE
  |  merging 2 SELECT CONSTANT
  |  cardinality: 10
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=4/4 size=460B
     table stats: 8 rows total
     column stats: all
     cardinality: 8
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=960.00MB VCores=1

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  8:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 2

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 8
    UNPARTITIONED

  10:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 2
  |
  4:SCAN HDFS
     table=functional.alltypestiny #partitions=4/4 size=460B
     table stats: 8 rows total
     column stats: all
     cardinality: 8
     per-host memory: 960.00MB
     tuple ids: 1

PLAN FRAGMENT 2
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 8
    UNPARTITIONED

  9:MERGE
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  2:AGGREGATE (finalize)
  |  group by: 1, 'a', null, f
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  5:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 2

PLAN FRAGMENT 3
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 5
    UNPARTITIONED

  7:MERGE
     merging 2 SELECT CONSTANT
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 2

PLAN FRAGMENT 4
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 5
    UNPARTITIONED

  6:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 2
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=4/4 size=460B
     table stats: 8 rows total
     column stats: all
     cardinality: 8
     per-host memory: 960.00MB
     tuple ids: 0
====
// UNION ALL/DISTINCT with mixed constant selects and non-constant selects and nested unions
(select 500
 union all
 (select int_col from functional.alltypestiny where year=2009 and month=2
  order by 1 limit 3
  union all
  select 500)
)
union distinct
select int_col from functional.alltypestiny where year=2009 and month=1
union all
select 503
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  5:MERGE
  |  merging 1 SELECT CONSTANT
  |  cardinality: 1
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  4:AGGREGATE (finalize)
  |  group by: 500
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  0:MERGE
  |  merging 2 SELECT CONSTANT
  |  cardinality: 6
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  |----3:SCAN HDFS
  |       table=functional.alltypestiny #partitions=1/4 size=115B
  |       table stats: 8 rows total
  |       column stats: all
  |       cardinality: 2
  |       per-host memory: unavailable
  |       tuple ids: 3
  |
  2:TOP-N
  |  order by: int_col ASC
  |  limit: 3
  |  cardinality: 2
  |  per-host memory: unavailable
  |  tuple ids: 0
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     column stats: all
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=960.00MB VCores=1

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  12:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 4

PLAN FRAGMENT 1
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 12
    UNPARTITIONED

  14:MERGE
     merging 1 SELECT CONSTANT
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 4

PLAN FRAGMENT 2
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 12
    UNPARTITIONED

  13:MERGE
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  4:AGGREGATE (finalize)
  |  group by: 500
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  8:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 4

PLAN FRAGMENT 3
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 8
    UNPARTITIONED

  11:MERGE
     merging 2 SELECT CONSTANT
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 4

PLAN FRAGMENT 4
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 8
    UNPARTITIONED

  10:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  3:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     column stats: all
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 3

PLAN FRAGMENT 5
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 8
    UNPARTITIONED

  9:MERGE
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  7:TOP-N
  |  order by: int_col ASC
  |  limit: 3
  |  cardinality: 2
  |  per-host memory: unavailable
  |  tuple ids: 0
  |
  6:EXCHANGE
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0

PLAN FRAGMENT 6
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 6
    UNPARTITIONED

  2:TOP-N
  |  order by: int_col ASC
  |  limit: 3
  |  cardinality: 2
  |  per-host memory: 24B
  |  tuple ids: 0
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=1/4 size=115B
     table stats: 8 rows total
     column stats: all
     cardinality: 2
     per-host memory: 960.00MB
     tuple ids: 0
====
// UNION ALL with only values statements
values(1, 'a', NULL, 10.f)
union all
values(2, 'b', NULL, 20.f)
union all
values(3, 'c', NULL, 30.f)
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:MERGE
     merging 3 SELECT CONSTANT
     cardinality: 3
     per-host memory: unavailable
     tuple ids: 3
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:MERGE
     merging 3 SELECT CONSTANT
     cardinality: 3
     per-host memory: unavailable
     tuple ids: 3
====
// UNION DISTINCT with only values statements
values(1, 'a', NULL, 10.0f)
union distinct
values(2, 'b', NULL, 20.0f)
union distinct
values(3, 'c', NULL, 30.0f)
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  1:AGGREGATE (finalize)
  |  group by: 1, 'a', null, f
  |  cardinality: 0
  |  per-host memory: unavailable
  |  tuple ids: 3
  |
  0:MERGE
     merging 3 SELECT CONSTANT
     cardinality: 3
     per-host memory: unavailable
     tuple ids: 3
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  1:AGGREGATE (finalize)
  |  group by: 1, 'a', null, f
  |  cardinality: 0
  |  per-host memory: unavailable
  |  tuple ids: 3
  |
  0:MERGE
     merging 3 SELECT CONSTANT
     cardinality: 3
     per-host memory: unavailable
     tuple ids: 3
====
// UNION ALL/DISTINCT with mixed values statements and non-constant selects
values(1, 'a', NULL, 10.f)
union all
select int_col, string_col, bool_col, float_col from functional.alltypestiny
union distinct
values(3, 'c', NULL, 30.f)
union all
select int_col, string_col, bool_col, float_col from functional.alltypessmall
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  3:MERGE
  |  cardinality: 100
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  |----4:SCAN HDFS
  |       table=functional.alltypessmall #partitions=4/4 size=6.32KB
  |       table stats: 100 rows total
  |       column stats: all
  |       cardinality: 100
  |       per-host memory: unavailable
  |       tuple ids: 3
  |
  2:AGGREGATE (finalize)
  |  group by: 1, 'a', null, f
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  0:MERGE
  |  merging 2 SELECT CONSTANT
  |  cardinality: 10
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=4/4 size=460B
     table stats: 8 rows total
     column stats: all
     cardinality: 8
     per-host memory: unavailable
     tuple ids: 1
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=960.00MB VCores=1

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  8:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 4

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 8
    UNPARTITIONED

  10:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  4:SCAN HDFS
     table=functional.alltypessmall #partitions=4/4 size=6.32KB
     table stats: 100 rows total
     column stats: all
     cardinality: 100
     per-host memory: 960.00MB
     tuple ids: 3

PLAN FRAGMENT 2
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 8
    UNPARTITIONED

  9:MERGE
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  2:AGGREGATE (finalize)
  |  group by: 1, 'a', null, f
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 4
  |
  5:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 4

PLAN FRAGMENT 3
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 5
    UNPARTITIONED

  7:MERGE
     merging 2 SELECT CONSTANT
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 4

PLAN FRAGMENT 4
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 5
    UNPARTITIONED

  6:MERGE
  |  cardinality: unavailable
  |  per-host memory: 0B
  |  tuple ids: 4
  |
  1:SCAN HDFS
     table=functional.alltypestiny #partitions=4/4 size=460B
     table stats: 8 rows total
     column stats: all
     cardinality: 8
     per-host memory: 960.00MB
     tuple ids: 1
====
