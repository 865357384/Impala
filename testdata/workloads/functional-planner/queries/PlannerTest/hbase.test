# full scan of string typed row-key
select * from functional_hbase.stringids
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:SCAN HBASE
     table:stringids
     table stats: 10000 rows total
     column stats: unavailable
     cardinality: 18309
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1024.00MB VCores=1

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  1:EXCHANGE
     cardinality: 18309
     per-host memory: unavailable
     tuple ids: 0

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 1
    UNPARTITIONED

  0:SCAN HBASE
     table:stringids
     table stats: 10000 rows total
     column stats: unavailable
     cardinality: 18309
     per-host memory: 1024.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
  HBASE KEYRANGE port=60201 <unbounded>:3
  HBASE KEYRANGE port=60202 3:7
  HBASE KEYRANGE port=60203 7:<unbounded>
====
# full scan
select * from functional_hbase.alltypessmall
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:SCAN HBASE
     table:alltypessmall
     table stats: 100 rows total
     column stats: unavailable
     cardinality: 200
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1024.00MB VCores=1

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  1:EXCHANGE
     cardinality: 200
     per-host memory: unavailable
     tuple ids: 0

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 1
    UNPARTITIONED

  0:SCAN HBASE
     table:alltypessmall
     table stats: 100 rows total
     column stats: unavailable
     cardinality: 200
     per-host memory: 1024.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
  HBASE KEYRANGE port=60201 <unbounded>:3
  HBASE KEYRANGE port=60202 3:7
  HBASE KEYRANGE port=60203 7:<unbounded>
====
# predicate on row key doesn't get transformed into scan parameter, because
# it's mapped as an int (but stored in ascii and ordered lexicographically)
select * from functional_hbase.alltypessmall
where id < 5
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:SCAN HBASE
     table:alltypessmall
     predicates: id < 5
     table stats: 100 rows total
     column stats: unavailable
     cardinality: 20
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1024.00MB VCores=1

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  1:EXCHANGE
     cardinality: 20
     per-host memory: unavailable
     tuple ids: 0

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 1
    UNPARTITIONED

  0:SCAN HBASE
     table:alltypessmall
     predicates: id < 5
     table stats: 100 rows total
     column stats: unavailable
     cardinality: 20
     per-host memory: 1024.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
  HBASE KEYRANGE port=60201 <unbounded>:3
  HBASE KEYRANGE port=60202 3:7
  HBASE KEYRANGE port=60203 7:<unbounded>
====
# if the row key is mapped as a string col, range predicates are applied to the scan
select * from functional_hbase.stringids
where id = '5'
and tinyint_col = 5
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:SCAN HBASE
     table:stringids
     start key: 5
     stop key: 5\0
     predicates: tinyint_col = 5
     table stats: 10000 rows total
     column stats: unavailable
     cardinality: 0
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1024.00MB VCores=1

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  1:EXCHANGE
     cardinality: 0
     per-host memory: unavailable
     tuple ids: 0

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 1
    UNPARTITIONED

  0:SCAN HBASE
     table:stringids
     start key: 5
     stop key: 5\0
     predicates: tinyint_col = 5
     table stats: 10000 rows total
     column stats: unavailable
     cardinality: 0
     per-host memory: 1024.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
  HBASE KEYRANGE port=60202 5:5\0
====
select * from functional_hbase.stringids
where id > '5'
and tinyint_col = 5
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:SCAN HBASE
     table:stringids
     start key: 5\0
     predicates: tinyint_col = 5
     table stats: 10000 rows total
     column stats: unavailable
     cardinality: 1008
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1024.00MB VCores=1

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  1:EXCHANGE
     cardinality: 1008
     per-host memory: unavailable
     tuple ids: 0

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 1
    UNPARTITIONED

  0:SCAN HBASE
     table:stringids
     start key: 5\0
     predicates: tinyint_col = 5
     table stats: 10000 rows total
     column stats: unavailable
     cardinality: 1008
     per-host memory: 1024.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
  HBASE KEYRANGE port=60202 5\0:7
  HBASE KEYRANGE port=60203 7:<unbounded>
====
select * from functional_hbase.stringids
where id >= '5'
and tinyint_col = 5
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:SCAN HBASE
     table:stringids
     start key: 5
     predicates: tinyint_col = 5
     table stats: 10000 rows total
     column stats: unavailable
     cardinality: 1008
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1024.00MB VCores=1

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  1:EXCHANGE
     cardinality: 1008
     per-host memory: unavailable
     tuple ids: 0

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 1
    UNPARTITIONED

  0:SCAN HBASE
     table:stringids
     start key: 5
     predicates: tinyint_col = 5
     table stats: 10000 rows total
     column stats: unavailable
     cardinality: 1008
     per-host memory: 1024.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
  HBASE KEYRANGE port=60202 5:7
  HBASE KEYRANGE port=60203 7:<unbounded>
====
select * from functional_hbase.stringids
where id < '5'
and tinyint_col = 5
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:SCAN HBASE
     table:stringids
     stop key: 5
     predicates: tinyint_col = 5
     table stats: 10000 rows total
     column stats: unavailable
     cardinality: 820
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1024.00MB VCores=1

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  1:EXCHANGE
     cardinality: 820
     per-host memory: unavailable
     tuple ids: 0

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 1
    UNPARTITIONED

  0:SCAN HBASE
     table:stringids
     stop key: 5
     predicates: tinyint_col = 5
     table stats: 10000 rows total
     column stats: unavailable
     cardinality: 820
     per-host memory: 1024.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
  HBASE KEYRANGE port=60201 <unbounded>:3
  HBASE KEYRANGE port=60202 3:5
====
select * from functional_hbase.stringids
where id <= '5'
and tinyint_col = 5
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:SCAN HBASE
     table:stringids
     stop key: 5\0
     predicates: tinyint_col = 5
     table stats: 10000 rows total
     column stats: unavailable
     cardinality: 1226
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1024.00MB VCores=1

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  1:EXCHANGE
     cardinality: 1226
     per-host memory: unavailable
     tuple ids: 0

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 1
    UNPARTITIONED

  0:SCAN HBASE
     table:stringids
     stop key: 5\0
     predicates: tinyint_col = 5
     table stats: 10000 rows total
     column stats: unavailable
     cardinality: 1226
     per-host memory: 1024.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
  HBASE KEYRANGE port=60201 <unbounded>:3
  HBASE KEYRANGE port=60202 3:5\0
====
select * from functional_hbase.stringids
where id > '4' and id < '5'
and tinyint_col = 5
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:SCAN HBASE
     table:stringids
     start key: 4\0
     stop key: 5
     predicates: tinyint_col = 5
     table stats: 10000 rows total
     column stats: unavailable
     cardinality: 402
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1024.00MB VCores=1

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  1:EXCHANGE
     cardinality: 402
     per-host memory: unavailable
     tuple ids: 0

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 1
    UNPARTITIONED

  0:SCAN HBASE
     table:stringids
     start key: 4\0
     stop key: 5
     predicates: tinyint_col = 5
     table stats: 10000 rows total
     column stats: unavailable
     cardinality: 402
     per-host memory: 1024.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
  HBASE KEYRANGE port=60202 4\0:5
====
select * from functional_hbase.stringids
where id >= '4' and id < '5'
and tinyint_col = 5
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:SCAN HBASE
     table:stringids
     start key: 4
     stop key: 5
     predicates: tinyint_col = 5
     table stats: 10000 rows total
     column stats: unavailable
     cardinality: 402
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1024.00MB VCores=1

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  1:EXCHANGE
     cardinality: 402
     per-host memory: unavailable
     tuple ids: 0

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 1
    UNPARTITIONED

  0:SCAN HBASE
     table:stringids
     start key: 4
     stop key: 5
     predicates: tinyint_col = 5
     table stats: 10000 rows total
     column stats: unavailable
     cardinality: 402
     per-host memory: 1024.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
  HBASE KEYRANGE port=60202 4:5
====
select * from functional_hbase.stringids
where id > '4' and id <= '5'
and tinyint_col = 5
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:SCAN HBASE
     table:stringids
     start key: 4\0
     stop key: 5\0
     predicates: tinyint_col = 5
     table stats: 10000 rows total
     column stats: unavailable
     cardinality: 806
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1024.00MB VCores=1

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  1:EXCHANGE
     cardinality: 806
     per-host memory: unavailable
     tuple ids: 0

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 1
    UNPARTITIONED

  0:SCAN HBASE
     table:stringids
     start key: 4\0
     stop key: 5\0
     predicates: tinyint_col = 5
     table stats: 10000 rows total
     column stats: unavailable
     cardinality: 806
     per-host memory: 1024.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
  HBASE KEYRANGE port=60202 4\0:5\0
====
select * from functional_hbase.stringids
where id >= '4' and id <= '5'
and tinyint_col = 5
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:SCAN HBASE
     table:stringids
     start key: 4
     stop key: 5\0
     predicates: tinyint_col = 5
     table stats: 10000 rows total
     column stats: unavailable
     cardinality: 806
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1024.00MB VCores=1

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  1:EXCHANGE
     cardinality: 806
     per-host memory: unavailable
     tuple ids: 0

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 1
    UNPARTITIONED

  0:SCAN HBASE
     table:stringids
     start key: 4
     stop key: 5\0
     predicates: tinyint_col = 5
     table stats: 10000 rows total
     column stats: unavailable
     cardinality: 806
     per-host memory: 1024.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
  HBASE KEYRANGE port=60202 4:5\0
====
# with aggregation
select int_col, count(*)
from functional_hbase.alltypessmall
where id < 5
group by 1
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  1:AGGREGATE (finalize)
  |  output: COUNT(*)
  |  group by: int_col
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 1
  |
  0:SCAN HBASE
     table:alltypessmall
     predicates: id < 5
     table stats: 100 rows total
     column stats: unavailable
     cardinality: 20
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1.13GB VCores=2

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  4:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 1

PLAN FRAGMENT 1
  PARTITION: HASH_PARTITIONED: int_col

  STREAM DATA SINK
    EXCHANGE ID: 4
    UNPARTITIONED

  3:AGGREGATE (merge finalize)
  |  output: SUM(COUNT(*))
  |  group by: int_col
  |  cardinality: unavailable
  |  per-host memory: 128.00MB
  |  tuple ids: 1
  |
  2:EXCHANGE
     cardinality: unavailable
     per-host memory: 0B
     tuple ids: 1

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 2
    HASH_PARTITIONED: int_col

  1:AGGREGATE
  |  output: COUNT(*)
  |  group by: int_col
  |  cardinality: unavailable
  |  per-host memory: 128.00MB
  |  tuple ids: 1
  |
  0:SCAN HBASE
     table:alltypessmall
     predicates: id < 5
     table stats: 100 rows total
     column stats: unavailable
     cardinality: 20
     per-host memory: 1024.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
  HBASE KEYRANGE port=60201 <unbounded>:3
  HBASE KEYRANGE port=60202 3:7
  HBASE KEYRANGE port=60203 7:<unbounded>
====
# predicates on string columns against a constant string are converted to HBase filters
select * from functional_hbase.alltypessmall where string_col = '4'
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:SCAN HBASE
     table:alltypessmall
     hbase filters: d:string_col EQUAL '4'
     table stats: 100 rows total
     column stats: unavailable
     cardinality: 20
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1024.00MB VCores=1

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  1:EXCHANGE
     cardinality: 20
     per-host memory: unavailable
     tuple ids: 0

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 1
    UNPARTITIONED

  0:SCAN HBASE
     table:alltypessmall
     hbase filters: d:string_col EQUAL '4'
     table stats: 100 rows total
     column stats: unavailable
     cardinality: 20
     per-host memory: 1024.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
  HBASE KEYRANGE port=60201 <unbounded>:3
  HBASE KEYRANGE port=60202 3:7
  HBASE KEYRANGE port=60203 7:<unbounded>
====
# test all comparison ops
select * from functional_hbase.alltypessmall where string_col != '4'
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:SCAN HBASE
     table:alltypessmall
     hbase filters: d:string_col NOT_EQUAL '4'
     table stats: 100 rows total
     column stats: unavailable
     cardinality: 20
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1024.00MB VCores=1

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  1:EXCHANGE
     cardinality: 20
     per-host memory: unavailable
     tuple ids: 0

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 1
    UNPARTITIONED

  0:SCAN HBASE
     table:alltypessmall
     hbase filters: d:string_col NOT_EQUAL '4'
     table stats: 100 rows total
     column stats: unavailable
     cardinality: 20
     per-host memory: 1024.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
  HBASE KEYRANGE port=60201 <unbounded>:3
  HBASE KEYRANGE port=60202 3:7
  HBASE KEYRANGE port=60203 7:<unbounded>
====
select * from functional_hbase.alltypessmall where string_col < '4'
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:SCAN HBASE
     table:alltypessmall
     hbase filters: d:string_col LESS '4'
     table stats: 100 rows total
     column stats: unavailable
     cardinality: 20
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1024.00MB VCores=1

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  1:EXCHANGE
     cardinality: 20
     per-host memory: unavailable
     tuple ids: 0

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 1
    UNPARTITIONED

  0:SCAN HBASE
     table:alltypessmall
     hbase filters: d:string_col LESS '4'
     table stats: 100 rows total
     column stats: unavailable
     cardinality: 20
     per-host memory: 1024.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
  HBASE KEYRANGE port=60201 <unbounded>:3
  HBASE KEYRANGE port=60202 3:7
  HBASE KEYRANGE port=60203 7:<unbounded>
====
select * from functional_hbase.alltypessmall where string_col > '4'
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:SCAN HBASE
     table:alltypessmall
     hbase filters: d:string_col GREATER '4'
     table stats: 100 rows total
     column stats: unavailable
     cardinality: 20
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1024.00MB VCores=1

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  1:EXCHANGE
     cardinality: 20
     per-host memory: unavailable
     tuple ids: 0

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 1
    UNPARTITIONED

  0:SCAN HBASE
     table:alltypessmall
     hbase filters: d:string_col GREATER '4'
     table stats: 100 rows total
     column stats: unavailable
     cardinality: 20
     per-host memory: 1024.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
  HBASE KEYRANGE port=60201 <unbounded>:3
  HBASE KEYRANGE port=60202 3:7
  HBASE KEYRANGE port=60203 7:<unbounded>
====
select * from functional_hbase.alltypessmall where string_col <= '4'
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:SCAN HBASE
     table:alltypessmall
     hbase filters: d:string_col LESS_OR_EQUAL '4'
     table stats: 100 rows total
     column stats: unavailable
     cardinality: 20
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1024.00MB VCores=1

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  1:EXCHANGE
     cardinality: 20
     per-host memory: unavailable
     tuple ids: 0

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 1
    UNPARTITIONED

  0:SCAN HBASE
     table:alltypessmall
     hbase filters: d:string_col LESS_OR_EQUAL '4'
     table stats: 100 rows total
     column stats: unavailable
     cardinality: 20
     per-host memory: 1024.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
  HBASE KEYRANGE port=60201 <unbounded>:3
  HBASE KEYRANGE port=60202 3:7
  HBASE KEYRANGE port=60203 7:<unbounded>
====
select * from functional_hbase.alltypessmall where string_col >= '4'
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:SCAN HBASE
     table:alltypessmall
     hbase filters: d:string_col GREATER_OR_EQUAL '4'
     table stats: 100 rows total
     column stats: unavailable
     cardinality: 20
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1024.00MB VCores=1

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  1:EXCHANGE
     cardinality: 20
     per-host memory: unavailable
     tuple ids: 0

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 1
    UNPARTITIONED

  0:SCAN HBASE
     table:alltypessmall
     hbase filters: d:string_col GREATER_OR_EQUAL '4'
     table stats: 100 rows total
     column stats: unavailable
     cardinality: 20
     per-host memory: 1024.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
  HBASE KEYRANGE port=60201 <unbounded>:3
  HBASE KEYRANGE port=60202 3:7
  HBASE KEYRANGE port=60203 7:<unbounded>
====
# test multiple filters
select * from functional_hbase.alltypessmall
where string_col >= '4' and string_col != '2' and date_string_col = '04/03/09'
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:SCAN HBASE
     table:alltypessmall
     hbase filters:
  d:date_string_col EQUAL '04/03/09'
  d:string_col GREATER_OR_EQUAL '4'
  d:string_col NOT_EQUAL '2'
     table stats: 100 rows total
     column stats: unavailable
     cardinality: 0
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1024.00MB VCores=1

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  1:EXCHANGE
     cardinality: 0
     per-host memory: unavailable
     tuple ids: 0

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 1
    UNPARTITIONED

  0:SCAN HBASE
     table:alltypessmall
     hbase filters:
  d:date_string_col EQUAL '04/03/09'
  d:string_col GREATER_OR_EQUAL '4'
  d:string_col NOT_EQUAL '2'
     table stats: 100 rows total
     column stats: unavailable
     cardinality: 0
     per-host memory: 1024.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
  HBASE KEYRANGE port=60201 <unbounded>:3
  HBASE KEYRANGE port=60202 3:7
  HBASE KEYRANGE port=60203 7:<unbounded>
====
# mix of predicates and functional_hbase. filters
select * from functional_hbase.alltypessmall where string_col = '4' and tinyint_col = 5
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:SCAN HBASE
     table:alltypessmall
     hbase filters: d:string_col EQUAL '4'
     predicates: tinyint_col = 5
     table stats: 100 rows total
     column stats: unavailable
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1024.00MB VCores=1

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  1:EXCHANGE
     cardinality: 2
     per-host memory: unavailable
     tuple ids: 0

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 1
    UNPARTITIONED

  0:SCAN HBASE
     table:alltypessmall
     hbase filters: d:string_col EQUAL '4'
     predicates: tinyint_col = 5
     table stats: 100 rows total
     column stats: unavailable
     cardinality: 2
     per-host memory: 1024.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
  HBASE KEYRANGE port=60201 <unbounded>:3
  HBASE KEYRANGE port=60202 3:7
  HBASE KEYRANGE port=60203 7:<unbounded>
====
# mix of predicates, functional_hbase. filters and start/stop keys
select * from functional_hbase.stringids
where string_col = '4' and tinyint_col = 5 and id >= '4' and id <= '5'
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:SCAN HBASE
     table:stringids
     start key: 4
     stop key: 5\0
     hbase filters: d:string_col EQUAL '4'
     predicates: tinyint_col = 5
     table stats: 10000 rows total
     column stats: unavailable
     cardinality: 80
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1024.00MB VCores=1

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  1:EXCHANGE
     cardinality: 80
     per-host memory: unavailable
     tuple ids: 0

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 1
    UNPARTITIONED

  0:SCAN HBASE
     table:stringids
     start key: 4
     stop key: 5\0
     hbase filters: d:string_col EQUAL '4'
     predicates: tinyint_col = 5
     table stats: 10000 rows total
     column stats: unavailable
     cardinality: 80
     per-host memory: 1024.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
  HBASE KEYRANGE port=60202 4:5\0
====
# predicates involving casts (ie, non-string comparisons) cannot be turned into filters
select * from functional_hbase.alltypessmall where cast(string_col as int) >= 4
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:SCAN HBASE
     table:alltypessmall
     predicates: CAST(string_col AS INT) >= 4
     table stats: 100 rows total
     column stats: unavailable
     cardinality: 20
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1024.00MB VCores=1

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  1:EXCHANGE
     cardinality: 20
     per-host memory: unavailable
     tuple ids: 0

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 1
    UNPARTITIONED

  0:SCAN HBASE
     table:alltypessmall
     predicates: CAST(string_col AS INT) >= 4
     table stats: 100 rows total
     column stats: unavailable
     cardinality: 20
     per-host memory: 1024.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
  HBASE KEYRANGE port=60201 <unbounded>:3
  HBASE KEYRANGE port=60202 3:7
  HBASE KEYRANGE port=60203 7:<unbounded>
====
# non-const comparisons cannot be turned into filters
select * from functional_hbase.alltypessmall where string_col >= date_string_col
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  0:SCAN HBASE
     table:alltypessmall
     predicates: string_col >= date_string_col
     table stats: 100 rows total
     column stats: unavailable
     cardinality: 20
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1024.00MB VCores=1

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  1:EXCHANGE
     cardinality: 20
     per-host memory: unavailable
     tuple ids: 0

PLAN FRAGMENT 1
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 1
    UNPARTITIONED

  0:SCAN HBASE
     table:alltypessmall
     predicates: string_col >= date_string_col
     table stats: 100 rows total
     column stats: unavailable
     cardinality: 20
     per-host memory: 1024.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
  HBASE KEYRANGE port=60201 <unbounded>:3
  HBASE KEYRANGE port=60202 3:7
  HBASE KEYRANGE port=60203 7:<unbounded>
====
