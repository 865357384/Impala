# IMPALA-6388: Verify that the order of the union operands does not impact the
# number of hosts computation
select f2 from functional.emptytable
union all
select int_col from functional.alltypes
---- DISTRIBUTEDPLAN
F03:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=0B mem-reservation=0B
PLAN-ROOT SINK
|  mem-estimate=0B mem-reservation=0B
|
03:EXCHANGE [UNPARTITIONED]
|  mem-estimate=0B mem-reservation=0B
|  tuple-ids=2 row-size=4B cardinality=7300
|
F02:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
Per-Host Resources: mem-estimate=128.00MB mem-reservation=0B
00:UNION
|  pass-through-operands: all
|  mem-estimate=0B mem-reservation=0B
|  tuple-ids=2 row-size=4B cardinality=7300
|
|--02:SCAN HDFS [functional.alltypes, RANDOM]
|     partitions=24/24 files=24 size=478.45KB
|     stats-rows=7300 extrapolated-rows=disabled
|     table stats: rows=7300 size=478.45KB
|     column stats: all
|     mem-estimate=128.00MB mem-reservation=0B
|     tuple-ids=1 row-size=4B cardinality=7300
|
01:SCAN HDFS [functional.emptytable, RANDOM]
   partitions=0/0 files=0 size=0B
   stats-rows=unavailable extrapolated-rows=disabled
   table stats: rows=unavailable size=unavailable
   column stats: all
   mem-estimate=0B mem-reservation=0B
   tuple-ids=0 row-size=4B cardinality=0
====
# IMPALA-6388: Verify that the order of the union operands does not impact the
# number of hosts computation
select int_col from functional.alltypes
union all
select f2 from functional.emptytable
---- DISTRIBUTEDPLAN
F03:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1
|  Per-Host Resources: mem-estimate=0B mem-reservation=0B
PLAN-ROOT SINK
|  mem-estimate=0B mem-reservation=0B
|
03:EXCHANGE [UNPARTITIONED]
|  mem-estimate=0B mem-reservation=0B
|  tuple-ids=2 row-size=4B cardinality=7300
|
F02:PLAN FRAGMENT [RANDOM] hosts=3 instances=3
Per-Host Resources: mem-estimate=128.00MB mem-reservation=0B
00:UNION
|  pass-through-operands: all
|  mem-estimate=0B mem-reservation=0B
|  tuple-ids=2 row-size=4B cardinality=7300
|
|--02:SCAN HDFS [functional.emptytable, RANDOM]
|     partitions=0/0 files=0 size=0B
|     stats-rows=unavailable extrapolated-rows=disabled
|     table stats: rows=unavailable size=unavailable
|     column stats: all
|     mem-estimate=0B mem-reservation=0B
|     tuple-ids=1 row-size=4B cardinality=0
|
01:SCAN HDFS [functional.alltypes, RANDOM]
   partitions=24/24 files=24 size=478.45KB
   stats-rows=7300 extrapolated-rows=disabled
   table stats: rows=7300 size=478.45KB
   column stats: all
   mem-estimate=128.00MB mem-reservation=0B
   tuple-ids=0 row-size=4B cardinality=7300
====
