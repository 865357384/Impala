# distinct *
select distinct *
from functional.testtbl
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  1:AGGREGATE (finalize)
  |  group by: functional.testtbl.id, functional.testtbl.name, functional.testtbl.zip
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 1
  |
  0:SCAN HDFS
     table=functional.testtbl #partitions=0/1 size=0B
     table stats: unavailable
     column stats: unavailable
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=970.00MB VCores=2

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  4:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 1

PLAN FRAGMENT 1
  PARTITION: HASH_PARTITIONED: functional.testtbl.id, functional.testtbl.name, functional.testtbl.zip

  STREAM DATA SINK
    EXCHANGE ID: 4
    UNPARTITIONED

  3:AGGREGATE (merge finalize)
  |  group by: functional.testtbl.id, functional.testtbl.name, functional.testtbl.zip
  |  cardinality: unavailable
  |  per-host memory: 10.00MB
  |  tuple ids: 1
  |
  2:EXCHANGE
     cardinality: unavailable
     per-host memory: 0B
     tuple ids: 1

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 2
    HASH_PARTITIONED: functional.testtbl.id, functional.testtbl.name, functional.testtbl.zip

  1:AGGREGATE
  |  group by: functional.testtbl.id, functional.testtbl.name, functional.testtbl.zip
  |  cardinality: unavailable
  |  per-host memory: 10.00MB
  |  tuple ids: 1
  |
  0:SCAN HDFS
     table=functional.testtbl #partitions=0/1 size=0B
     table stats: unavailable
     column stats: unavailable
     cardinality: unavailable
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
====
# distinct w/ explicit select list
select distinct id, zip
from functional.testtbl
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  1:AGGREGATE (finalize)
  |  group by: id, zip
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 1
  |
  0:SCAN HDFS
     table=functional.testtbl #partitions=0/1 size=0B
     table stats: unavailable
     column stats: unavailable
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=970.00MB VCores=2

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  4:EXCHANGE
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 1

PLAN FRAGMENT 1
  PARTITION: HASH_PARTITIONED: id, zip

  STREAM DATA SINK
    EXCHANGE ID: 4
    UNPARTITIONED

  3:AGGREGATE (merge finalize)
  |  group by: id, zip
  |  cardinality: unavailable
  |  per-host memory: 10.00MB
  |  tuple ids: 1
  |
  2:EXCHANGE
     cardinality: unavailable
     per-host memory: 0B
     tuple ids: 1

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 2
    HASH_PARTITIONED: id, zip

  1:AGGREGATE
  |  group by: id, zip
  |  cardinality: unavailable
  |  per-host memory: 10.00MB
  |  tuple ids: 1
  |
  0:SCAN HDFS
     table=functional.testtbl #partitions=0/1 size=0B
     table stats: unavailable
     column stats: unavailable
     cardinality: unavailable
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
====
# count(distinct)
select count(distinct id, zip)
from functional.testtbl
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  2:AGGREGATE (merge finalize)
  |  output: COUNT(if(id IS NULL, NULL, zip))
  |  group by:
  |  cardinality: 1
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  1:AGGREGATE
  |  group by: id, zip
  |  cardinality: unavailable
  |  per-host memory: unavailable
  |  tuple ids: 1
  |
  0:SCAN HDFS
     table=functional.testtbl #partitions=0/1 size=0B
     table stats: unavailable
     column stats: unavailable
     cardinality: unavailable
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=970.00MB VCores=2

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  6:AGGREGATE (merge finalize)
  |  output: SUM(COUNT(if(id IS NULL, NULL, zip)))
  |  group by:
  |  cardinality: 1
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  5:EXCHANGE
     cardinality: 1
     per-host memory: unavailable
     tuple ids: 2

PLAN FRAGMENT 1
  PARTITION: HASH_PARTITIONED: id, zip

  STREAM DATA SINK
    EXCHANGE ID: 5
    UNPARTITIONED

  2:AGGREGATE (merge)
  |  output: COUNT(if(id IS NULL, NULL, zip))
  |  group by:
  |  cardinality: 1
  |  per-host memory: 10.00MB
  |  tuple ids: 2
  |
  4:AGGREGATE (merge)
  |  group by: id, zip
  |  cardinality: unavailable
  |  per-host memory: 10.00MB
  |  tuple ids: 1
  |
  3:EXCHANGE
     cardinality: unavailable
     per-host memory: 0B
     tuple ids: 1

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 3
    HASH_PARTITIONED: id, zip

  1:AGGREGATE
  |  group by: id, zip
  |  cardinality: unavailable
  |  per-host memory: 10.00MB
  |  tuple ids: 1
  |
  0:SCAN HDFS
     table=functional.testtbl #partitions=0/1 size=0B
     table stats: unavailable
     column stats: unavailable
     cardinality: unavailable
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
====
# count(distinct) w/ grouping
select tinyint_col, count(distinct int_col, bigint_col)
from functional.alltypesagg
group by 1
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  2:AGGREGATE (merge finalize)
  |  output: COUNT(if(int_col IS NULL, NULL, bigint_col))
  |  group by: tinyint_col
  |  cardinality: 11
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  1:AGGREGATE
  |  group by: tinyint_col, int_col, bigint_col
  |  cardinality: 6810496
  |  per-host memory: unavailable
  |  tuple ids: 1
  |
  0:SCAN HDFS
     table=functional.alltypesagg #partitions=10/10 size=743.67KB
     table stats: 10000 rows total
     column stats: all
     cardinality: 10000
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=1.03GB VCores=2

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  5:EXCHANGE
     cardinality: 11
     per-host memory: unavailable
     tuple ids: 2

PLAN FRAGMENT 1
  PARTITION: HASH_PARTITIONED: tinyint_col

  STREAM DATA SINK
    EXCHANGE ID: 5
    UNPARTITIONED

  2:AGGREGATE (merge finalize)
  |  output: COUNT(if(int_col IS NULL, NULL, bigint_col))
  |  group by: tinyint_col
  |  cardinality: 11
  |  per-host memory: 10.00MB
  |  tuple ids: 2
  |
  4:AGGREGATE (merge)
  |  group by: tinyint_col, int_col, bigint_col
  |  cardinality: 6810496
  |  per-host memory: 25.33MB
  |  tuple ids: 1
  |
  3:EXCHANGE
     cardinality: 6810496
     per-host memory: 0B
     tuple ids: 1

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 3
    HASH_PARTITIONED: tinyint_col

  1:AGGREGATE
  |  group by: tinyint_col, int_col, bigint_col
  |  cardinality: 6810496
  |  per-host memory: 92.88MB
  |  tuple ids: 1
  |
  0:SCAN HDFS
     table=functional.alltypesagg #partitions=10/10 size=743.67KB
     table stats: 10000 rows total
     column stats: all
     cardinality: 10000
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=1/100101.txt 0:75153
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=10/100110.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=2/100102.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=3/100103.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=4/100104.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=5/100105.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=6/100106.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=7/100107.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=8/100108.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=9/100109.txt 0:76263
====
# count(distinct) and sum(distinct) w/ grouping
select tinyint_col, count(distinct int_col), sum(distinct int_col)
from functional.alltypesagg
group by 1
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  2:AGGREGATE (merge finalize)
  |  output: COUNT(int_col), SUM(int_col)
  |  group by: tinyint_col
  |  cardinality: 11
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  1:AGGREGATE
  |  group by: tinyint_col, int_col
  |  cardinality: 7601
  |  per-host memory: unavailable
  |  tuple ids: 1
  |
  0:SCAN HDFS
     table=functional.alltypesagg #partitions=10/10 size=743.67KB
     table stats: 10000 rows total
     column stats: all
     cardinality: 10000
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=970.00MB VCores=2

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  5:EXCHANGE
     cardinality: 11
     per-host memory: unavailable
     tuple ids: 2

PLAN FRAGMENT 1
  PARTITION: HASH_PARTITIONED: tinyint_col

  STREAM DATA SINK
    EXCHANGE ID: 5
    UNPARTITIONED

  2:AGGREGATE (merge finalize)
  |  output: COUNT(int_col), SUM(int_col)
  |  group by: tinyint_col
  |  cardinality: 11
  |  per-host memory: 10.00MB
  |  tuple ids: 2
  |
  4:AGGREGATE (merge)
  |  group by: tinyint_col, int_col
  |  cardinality: 7601
  |  per-host memory: 10.00MB
  |  tuple ids: 1
  |
  3:EXCHANGE
     cardinality: 7601
     per-host memory: 0B
     tuple ids: 1

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 3
    HASH_PARTITIONED: tinyint_col

  1:AGGREGATE
  |  group by: tinyint_col, int_col
  |  cardinality: 7601
  |  per-host memory: 10.00MB
  |  tuple ids: 1
  |
  0:SCAN HDFS
     table=functional.alltypesagg #partitions=10/10 size=743.67KB
     table stats: 10000 rows total
     column stats: all
     cardinality: 10000
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=1/100101.txt 0:75153
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=10/100110.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=2/100102.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=3/100103.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=4/100104.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=5/100105.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=6/100106.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=7/100107.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=8/100108.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=9/100109.txt 0:76263
====
# count(distinct) and sum(distinct) w/ grouping; distinct in min() and max()
# is ignored
select tinyint_col, count(distinct int_col),
min(distinct smallint_col), max(distinct string_col)
from functional.alltypesagg group by 1
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  2:AGGREGATE (merge finalize)
  |  output: COUNT(int_col), MIN(MIN(smallint_col)), MAX(MAX(string_col))
  |  group by: tinyint_col
  |  cardinality: 11
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  1:AGGREGATE
  |  output: MIN(smallint_col), MAX(string_col)
  |  group by: tinyint_col, int_col
  |  cardinality: 7601
  |  per-host memory: unavailable
  |  tuple ids: 1
  |
  0:SCAN HDFS
     table=functional.alltypesagg #partitions=10/10 size=743.67KB
     table stats: 10000 rows total
     column stats: all
     cardinality: 10000
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=970.00MB VCores=2

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  5:EXCHANGE
     cardinality: 11
     per-host memory: unavailable
     tuple ids: 2

PLAN FRAGMENT 1
  PARTITION: HASH_PARTITIONED: tinyint_col

  STREAM DATA SINK
    EXCHANGE ID: 5
    UNPARTITIONED

  2:AGGREGATE (merge finalize)
  |  output: COUNT(int_col), MIN(MIN(smallint_col)), MAX(MAX(string_col))
  |  group by: tinyint_col
  |  cardinality: 11
  |  per-host memory: 10.00MB
  |  tuple ids: 2
  |
  4:AGGREGATE (merge)
  |  output: MIN(MIN(smallint_col)), MAX(MAX(string_col))
  |  group by: tinyint_col, int_col
  |  cardinality: 7601
  |  per-host memory: 10.00MB
  |  tuple ids: 1
  |
  3:EXCHANGE
     cardinality: 7601
     per-host memory: 0B
     tuple ids: 1

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 3
    HASH_PARTITIONED: tinyint_col

  1:AGGREGATE
  |  output: MIN(smallint_col), MAX(string_col)
  |  group by: tinyint_col, int_col
  |  cardinality: 7601
  |  per-host memory: 10.00MB
  |  tuple ids: 1
  |
  0:SCAN HDFS
     table=functional.alltypesagg #partitions=10/10 size=743.67KB
     table stats: 10000 rows total
     column stats: all
     cardinality: 10000
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=1/100101.txt 0:75153
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=10/100110.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=2/100102.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=3/100103.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=4/100104.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=5/100105.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=6/100106.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=7/100107.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=8/100108.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=9/100109.txt 0:76263
====
# aggregate fns with and without distinct
select tinyint_col, count(distinct int_col), count(*), sum(distinct int_col),
sum(int_col), min(smallint_col), max(bigint_col)
from functional.alltypesagg group by 1
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  2:AGGREGATE (merge finalize)
  |  output: COUNT(int_col), SUM(int_col), SUM(COUNT(*)), SUM(SUM(int_col)), MIN(MIN(smallint_col)), MAX(MAX(bigint_col))
  |  group by: tinyint_col
  |  cardinality: 11
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  1:AGGREGATE
  |  output: COUNT(*), SUM(int_col), MIN(smallint_col), MAX(bigint_col)
  |  group by: tinyint_col, int_col
  |  cardinality: 7601
  |  per-host memory: unavailable
  |  tuple ids: 1
  |
  0:SCAN HDFS
     table=functional.alltypesagg #partitions=10/10 size=743.67KB
     table stats: 10000 rows total
     column stats: all
     cardinality: 10000
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=970.00MB VCores=2

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  5:EXCHANGE
     cardinality: 11
     per-host memory: unavailable
     tuple ids: 2

PLAN FRAGMENT 1
  PARTITION: HASH_PARTITIONED: tinyint_col

  STREAM DATA SINK
    EXCHANGE ID: 5
    UNPARTITIONED

  2:AGGREGATE (merge finalize)
  |  output: COUNT(int_col), SUM(int_col), SUM(COUNT(*)), SUM(SUM(int_col)), MIN(MIN(smallint_col)), MAX(MAX(bigint_col))
  |  group by: tinyint_col
  |  cardinality: 11
  |  per-host memory: 10.00MB
  |  tuple ids: 2
  |
  4:AGGREGATE (merge)
  |  output: SUM(COUNT(*)), SUM(SUM(int_col)), MIN(MIN(smallint_col)), MAX(MAX(bigint_col))
  |  group by: tinyint_col, int_col
  |  cardinality: 7601
  |  per-host memory: 10.00MB
  |  tuple ids: 1
  |
  3:EXCHANGE
     cardinality: 7601
     per-host memory: 0B
     tuple ids: 1

PLAN FRAGMENT 2
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 3
    HASH_PARTITIONED: tinyint_col

  1:AGGREGATE
  |  output: COUNT(*), SUM(int_col), MIN(smallint_col), MAX(bigint_col)
  |  group by: tinyint_col, int_col
  |  cardinality: 7601
  |  per-host memory: 10.00MB
  |  tuple ids: 1
  |
  0:SCAN HDFS
     table=functional.alltypesagg #partitions=10/10 size=743.67KB
     table stats: 10000 rows total
     column stats: all
     cardinality: 10000
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=1/100101.txt 0:75153
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=10/100110.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=2/100102.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=3/100103.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=4/100104.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=5/100105.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=6/100106.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=7/100107.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=8/100108.txt 0:76263
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypesagg/year=2010/month=1/day=9/100109.txt 0:76263
====
# test join on inline views containing distinct aggregates to make sure
# the aggregation info reports the correct tuple ids (from the 2nd phase
# distinct aggregation) for the inline-view expression substitution
select t1.c, t2.c from
(select count(distinct int_col) as c from functional.alltypestiny) t1 inner join
(select count(distinct bigint_col) as c from functional.alltypestiny) t2 on (t1.c = t2.c)
---- PLAN
Estimated Per-Host Requirements: Memory=0B VCores=0

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  6:HASH JOIN
  |  join op: INNER JOIN
  |  hash predicates:
  |    COUNT(int_col) = COUNT(bigint_col)
  |  cardinality: 1
  |  per-host memory: unavailable
  |  tuple ids: 2 6
  |
  |----5:AGGREGATE (merge finalize)
  |    |  output: COUNT(bigint_col)
  |    |  group by:
  |    |  cardinality: 1
  |    |  per-host memory: unavailable
  |    |  tuple ids: 6
  |    |
  |    4:AGGREGATE
  |    |  group by: bigint_col
  |    |  cardinality: 2
  |    |  per-host memory: unavailable
  |    |  tuple ids: 5
  |    |
  |    3:SCAN HDFS
  |       table=functional.alltypestiny #partitions=4/4 size=460B
  |       table stats: 8 rows total
  |       column stats: all
  |       cardinality: 8
  |       per-host memory: unavailable
  |       tuple ids: 4
  |
  2:AGGREGATE (merge finalize)
  |  output: COUNT(int_col)
  |  group by:
  |  cardinality: 1
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  1:AGGREGATE
  |  group by: int_col
  |  cardinality: 2
  |  per-host memory: unavailable
  |  tuple ids: 1
  |
  0:SCAN HDFS
     table=functional.alltypestiny #partitions=4/4 size=460B
     table stats: 8 rows total
     column stats: all
     cardinality: 8
     per-host memory: unavailable
     tuple ids: 0
---- DISTRIBUTEDPLAN
Estimated Per-Host Requirements: Memory=970.00MB VCores=2

PLAN FRAGMENT 0
  PARTITION: UNPARTITIONED

  6:HASH JOIN
  |  join op: INNER JOIN (BROADCAST)
  |  hash predicates:
  |    COUNT(int_col) = COUNT(bigint_col)
  |  cardinality: 1
  |  per-host memory: unavailable
  |  tuple ids: 2 6
  |
  |----15:EXCHANGE
  |       cardinality: 1
  |       per-host memory: unavailable
  |       tuple ids: 6
  |
  10:AGGREGATE (merge finalize)
  |  output: SUM(COUNT(int_col))
  |  group by:
  |  cardinality: 1
  |  per-host memory: unavailable
  |  tuple ids: 2
  |
  9:EXCHANGE
     cardinality: 1
     per-host memory: unavailable
     tuple ids: 2

PLAN FRAGMENT 1
  PARTITION: UNPARTITIONED

  STREAM DATA SINK
    EXCHANGE ID: 15
    UNPARTITIONED

  14:AGGREGATE (merge finalize)
  |  output: SUM(COUNT(bigint_col))
  |  group by:
  |  cardinality: 1
  |  per-host memory: unavailable
  |  tuple ids: 6
  |
  13:EXCHANGE
     cardinality: 1
     per-host memory: unavailable
     tuple ids: 6

PLAN FRAGMENT 2
  PARTITION: HASH_PARTITIONED: bigint_col

  STREAM DATA SINK
    EXCHANGE ID: 13
    UNPARTITIONED

  5:AGGREGATE (merge)
  |  output: COUNT(bigint_col)
  |  group by:
  |  cardinality: 1
  |  per-host memory: 10.00MB
  |  tuple ids: 6
  |
  12:AGGREGATE (merge)
  |  group by: bigint_col
  |  cardinality: 2
  |  per-host memory: 10.00MB
  |  tuple ids: 5
  |
  11:EXCHANGE
     cardinality: 2
     per-host memory: 0B
     tuple ids: 5

PLAN FRAGMENT 3
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 11
    HASH_PARTITIONED: bigint_col

  4:AGGREGATE
  |  group by: bigint_col
  |  cardinality: 2
  |  per-host memory: 10.00MB
  |  tuple ids: 5
  |
  3:SCAN HDFS
     table=functional.alltypestiny #partitions=4/4 size=460B
     table stats: 8 rows total
     column stats: all
     cardinality: 8
     per-host memory: 960.00MB
     tuple ids: 4

PLAN FRAGMENT 4
  PARTITION: HASH_PARTITIONED: int_col

  STREAM DATA SINK
    EXCHANGE ID: 9
    UNPARTITIONED

  2:AGGREGATE (merge)
  |  output: COUNT(int_col)
  |  group by:
  |  cardinality: 1
  |  per-host memory: 10.00MB
  |  tuple ids: 2
  |
  8:AGGREGATE (merge)
  |  group by: int_col
  |  cardinality: 2
  |  per-host memory: 10.00MB
  |  tuple ids: 1
  |
  7:EXCHANGE
     cardinality: 2
     per-host memory: 0B
     tuple ids: 1

PLAN FRAGMENT 5
  PARTITION: RANDOM

  STREAM DATA SINK
    EXCHANGE ID: 7
    HASH_PARTITIONED: int_col

  1:AGGREGATE
  |  group by: int_col
  |  cardinality: 2
  |  per-host memory: 10.00MB
  |  tuple ids: 1
  |
  0:SCAN HDFS
     table=functional.alltypestiny #partitions=4/4 size=460B
     table stats: 8 rows total
     column stats: all
     cardinality: 8
     per-host memory: 960.00MB
     tuple ids: 0
---- SCANRANGELOCATIONS
NODE 0:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=3/090301.txt 0:115
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=4/090401.txt 0:115
NODE 3:
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=1/090101.txt 0:115
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=2/090201.txt 0:115
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=3/090301.txt 0:115
  HDFS SPLIT hdfs://localhost:20500/test-warehouse/alltypestiny/year=2009/month=4/090401.txt 0:115
====
