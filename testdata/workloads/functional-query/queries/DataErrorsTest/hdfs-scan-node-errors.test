# TODO: Only the first error is listed here. Update the error list when ImpalaServer
# can return all the conversion errors.
# TODO: the error info should be sufficient to pin point the data location: filename and
# offset
# TODO: printing the entire record will break column level security (when it is
# implemented).
# TODO: the row index (rc file) is useless. It's the row index within the batch. When
# the batch size is zero, it's always zero.

select id, bool_col, tinyint_col, smallint_col from alltypeserror$TABLE
---- ERRORS
Error converting column: 1 TO BOOL (Data is: errfalse)
file: hdfs: test-warehouse/alltypeserror/year=2009/month=1
record: 1,errfalse,,1,1,10,1.000000,10.100000,01/01/09,1,1999-10-10
---- ERRORS_RC
Error converting column: 1 TO BOOL (Data is: errfalse)
file: hdfs: test-warehouse/alltypeserror$TABLE/year=2009/month=1
row index: 1
row index: 0
---- ERRORS_SEQ
Error converting column: 1 TO BOOL (Data is: errfalse)
file: hdfs: test-warehouse/alltypeserror$TABLE/year=2009/month=1
record: 1,errfalse,,1,1,10,1.000000,10.100000,01/01/09,1,1999-10-10
---- TYPES
int, boolean, tinyint, smallint
---- RESULTS
0,NULL,NULL,0
1,NULL,NULL,1
10,NULL,NULL,NULL
11,false,NULL,NULL
12,true,2,NULL
13,false,3,3
14,true,4,4
15,false,NULL,5
16,NULL,NULL,NULL
17,false,7,7
18,true,8,8
19,false,9,9
2,true,NULL,NULL
20,true,0,0
21,false,1,1
22,true,2,2
23,false,3,NULL
24,true,4,4
25,false,5,5
26,true,6,6
27,false,NULL,7
28,true,8,8
29,false,9,9
3,false,3,NULL
4,true,4,4
5,false,5,5
6,true,6,6
7,NULL,NULL,7
8,false,NULL,NULL
9,NULL,NULL,NULL
====
select * from alltypeserrornonulls$TABLE
---- ERRORS
Error converting column: 10 TO TIMESTAMP (Data is: 123456)
record: 0,true,0,0,0,0,0.000000,0.000000,01/01/09,0,123456
file: hdfs: test-warehouse/alltypeserrornonulls/year=2009/month=1
---- ERRORS_RC
Error converting column: 10 TO TIMESTAMP (Data is: 123456)
file: hdfs: test-warehouse/alltypeserrornonulls$TABLE/year=2009/month=1
row index: 1
row index: 0
---- ERRORS_SEQ
Error converting column: 10 TO TIMESTAMP (Data is: 123456)
file: hdfs: test-warehouse/alltypeserrornonulls$TABLE/year=2009/month=1
record: 0,true,0,0,0,0,0.000000,0.000000,01/01/09,0,123456
---- TYPES
int, int, int, boolean, tinyint, smallint, int, bigint, float, double, string, string, timestamp
---- RESULTS
2009,1,0,true,0,0,0,0,0,0,'01/01/09','0',NULL
2009,1,1,NULL,1,1,1,10,1,10.1,'01/01/09','1',NULL
2009,1,2,true,NULL,2,2,20,2,20.2,'01/01/09','2',2012-03-22 11:20:01.123000000
2009,1,3,false,3,NULL,3,30,3,30.3,'01/01/09','3',2012-03-22 11:20:01.123000000
2009,1,4,true,4,4,NULL,40,4,40.4,'01/01/09','4',2012-03-22 11:20:01.123000000
2009,1,5,false,5,5,5,NULL,5,50.5,'01/01/09','5',2012-03-22 11:20:01.123000000
2009,1,6,true,6,6,6,60,NULL,60.6,'01/01/09','6',2012-03-22 11:20:01.123000000
2009,1,7,false,7,7,7,70,7,NULL,'01/01/09','7',2012-03-22 11:20:01.123000000
2009,1,8,false,8,8,8,80,8,80.8,'01/01/09','8',2012-03-22 11:20:01.123000000
2009,1,9,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'01/01/09','9',2012-03-22 11:20:01.123000000
2009,2,10,true,0,0,0,0,0,0,'02/01/09','0',2012-03-22 11:20:01.123000000
2009,2,11,false,1,1,1,10,1,10.1,'02/01/09','1',2012-03-22 11:20:01.123000000
2009,2,12,true,2,2,2,20,2,20.2,'02/01/09','2',2012-03-22 11:20:01.123000000
2009,2,13,false,3,3,3,30,NULL,NULL,'02/01/09','3',2012-03-22 11:20:01.123000000
2009,2,14,true,4,4,4,40,4,40.4,'02/01/09','4',2012-03-22 11:20:01.123000000
2009,2,15,false,NULL,5,5,50,5,50.5,'02/01/09','5',2012-03-22 11:20:01.123000000
2009,2,16,true,6,6,6,60,6,60.6,'02/01/09','6',2012-03-22 11:20:01.123000000
2009,2,17,false,7,7,7,70,7,NULL,'02/01/09','7',2012-03-22 11:20:01.123000000
2009,2,18,true,8,8,8,80,8,80.8,'02/01/09','8',2012-03-22 11:20:01.123000000
2009,2,19,false,9,9,9,90,9,90.90000000000001,'02/01/09','9',2012-03-22 11:20:01.123000000
2009,3,20,true,0,0,0,0,0,0,'03/01/09','0',2012-03-22 11:20:01.123000000
2009,3,21,false,1,1,1,10,1,10.1,'03/01/09','1',2012-03-22 11:20:01.123000000
2009,3,22,true,2,2,2,20,2,20.2,'03/01/09','2',2012-03-22 11:20:01.123000000
2009,3,23,false,3,NULL,3,30,3,30.3,'03/01/09','3',2012-03-22 11:20:01.123000000
2009,3,24,true,4,4,4,40,4,40.4,'03/01/09','4',2012-03-22 11:20:01.123000000
2009,3,25,false,5,5,NULL,50,5,50.5,'03/01/09','5',2012-03-22 11:20:01.123000000
2009,3,26,true,6,6,6,60,6,60.6,'03/01/09','6',2012-03-22 11:20:01.123000000
2009,3,27,false,NULL,7,7,70,7,70.7,'03/01/09','7',2012-03-22 11:20:01.123000000
2009,3,28,true,8,8,8,80,8,80.8,'03/01/09','8',NULL
2009,3,29,false,9,9,NULL,90,9,90.90000000000001,'03/01/09','9',2012-03-22
====