====
---- QUERY
drop function if exists udf_test.identity(boolean);
drop function if exists udf_test.identity(tinyint);
drop function if exists udf_test.identity(smallint);
drop function if exists udf_test.identity(int);
drop function if exists udf_test.identity(bigint);
drop function if exists udf_test.identity(float);
drop function if exists udf_test.identity(double);
drop function if exists udf_test.identity(string);
drop function if exists udf_test.identity(timestamp);
drop function if exists udf_test.all_types_fn(
    string, boolean, tinyint, smallint, int, bigint, float, double);
drop function if exists udf_test.no_args();
drop function if exists udf_test.var_sum(int...);
drop function if exists udf_test.var_sum_multiply(double, int...);
drop function if exists udf_test.constant_timestamp();

drop function if exists uda_test.test_count(int);
drop function if exists uda_test.hll(int);

create database if not exists udf_test;
create database if not exists uda_test;

create function udf_test.identity(boolean) returns boolean
location '/test-warehouse/libTestUdfs.so' symbol='Identity';

create function udf_test.identity(tinyint) returns tinyint
location '/test-warehouse/libTestUdfs.so' symbol='Identity';

create function udf_test.identity(smallint) returns smallint
location '/test-warehouse/libTestUdfs.so' symbol='Identity';

create function udf_test.identity(int) returns int
location '/test-warehouse/libTestUdfs.so' symbol='Identity';

create function udf_test.identity(bigint) returns bigint
location '/test-warehouse/libTestUdfs.so' symbol='Identity';

create function udf_test.identity(float) returns float
location '/test-warehouse/libTestUdfs.so' symbol='Identity';

create function udf_test.identity(double) returns double
location '/test-warehouse/libTestUdfs.so' symbol='Identity';

create function udf_test.identity(string) returns string
location '/test-warehouse/libTestUdfs.so'
symbol='_Z8IdentityPN10impala_udf15FunctionContextERKNS_9StringValE';

create function udf_test.identity(timestamp) returns timestamp
location '/test-warehouse/libTestUdfs.so'
symbol='_Z8IdentityPN10impala_udf15FunctionContextERKNS_12TimestampValE';

create function udf_test.all_types_fn(
    string, boolean, tinyint, smallint, int, bigint, float, double)
returns int
location '/test-warehouse/libTestUdfs.so' symbol='AllTypes';

create function udf_test.no_args() returns string
location '/test-warehouse/libTestUdfs.so'
symbol='_Z6NoArgsPN10impala_udf15FunctionContextE';

create function udf_test.var_sum(int...) returns int
location '/test-warehouse/libTestUdfs.so' symbol='VarSum';

create function udf_test.var_sum_multiply(double, int...) returns double
location '/test-warehouse/libTestUdfs.so'
symbol='_Z14VarSumMultiplyPN10impala_udf15FunctionContextERKNS_9DoubleValEiPKNS_6IntValE';

create aggregate function uda_test.test_count(int) returns bigint
location '/test-warehouse/libudasample.so' update_fn='CountUpdate';

create aggregate function uda_test.hll(int) returns string
location '/test-warehouse/libudasample.so' update_fn='HllUpdate';

create function udf_test.constant_timestamp() returns timestamp
location '/test-warehouse/libTestUdfs.so'
symbol='_Z17ConstantTimestampPN10impala_udf15FunctionContextE';
====
