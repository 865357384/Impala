# join between hdfs and hbase, extra join predicate, extra scan predicates, nulls in
# joins cols and non-equality join predicate
# (alltypesagg.tinyint_col contains nulls instead of 0s)
# Should be same result as the test below
select a.tinyint_col, b.id, a.string_col, a.tinyint_col + b.tinyint_col
from alltypesagg a join hbasealltypessmall b
     on (a.tinyint_col = b.id and a.tinyint_col + b.tinyint_col < 5)
where a.month=1
and a.day=1
and a.string_col > '88'
and b.bool_col = false
---- RESULTS
1,1,'91',2
1,1,'881',2
1,1,'891',2
1,1,'901',2
1,1,'911',2
1,1,'921',2
1,1,'931',2
1,1,'941',2
1,1,'951',2
1,1,'961',2
1,1,'971',2
1,1,'981',2
1,1,'991',2
---- TYPES
tinyint, int, string, bigint
====
# join between hdfs and hbase, extra join predicate, extra scan predicates, nulls in joins cols
# (alltypesagg.tinyint_col contains nulls instead of 0s)
# Should be same result as the test below
select a.tinyint_col, b.id, a.string_col
from alltypesagg a join hbasealltypessmall b on (a.tinyint_col = b.id)
where a.month=1
and a.day=1
and a.tinyint_col + b.tinyint_col < 5
and a.string_col > '88'
and b.bool_col = false
---- RESULTS
1,1,'91'
1,1,'881'
1,1,'891'
1,1,'901'
1,1,'911'
1,1,'921'
1,1,'931'
1,1,'941'
1,1,'951'
1,1,'961'
1,1,'971'
1,1,'981'
1,1,'991'
---- TYPES
tinyint, int, string
====

# join between two tables, extra join predicate, extra scan predicates, nulls in joins cols
# (alltypesagg.tinyint_col contains nulls instead of 0s)
select a.tinyint_col, b.id, a.string_col
from alltypesagg a join alltypessmall b on (a.tinyint_col = b.id)
where a.month=1
and a.day=1
and a.tinyint_col + b.tinyint_col < 5
and a.string_col > '88'
and b.bool_col = false
---- RESULTS
1,1,'91'
1,1,'881'
1,1,'891'
1,1,'901'
1,1,'911'
1,1,'921'
1,1,'931'
1,1,'941'
1,1,'951'
1,1,'961'
1,1,'971'
1,1,'981'
1,1,'991'
---- TYPES
tinyint, int, string
====
# reversing the order of the tables produces the same result
select a.tinyint_col, b.id, a.string_col
from alltypessmall b join alltypesagg a on (a.tinyint_col = b.id)
where a.month=1
and a.day=1
and a.tinyint_col + b.tinyint_col < 5
and a.string_col > '88'
and b.bool_col = false
----
tinyint, int, string
----
1,1,'91'
1,1,'881'
1,1,'891'
1,1,'901'
1,1,'911'
1,1,'921'
1,1,'931'
1,1,'941'
1,1,'951'
1,1,'961'
1,1,'971'
1,1,'981'
1,1,'991'
====
# join between three tables, extra join predicates, extra scan predicates, nulls in joins cols
# (alltypesagg.tinyint_col contains nulls instead of 0s)
select a.smallint_col, b.id, a.tinyint_col, c.id, a.int_col, b.float_col, c.string_col
from alltypesagg a
join alltypessmall b on (a.smallint_col = b.id)
join alltypessmall c on (a.tinyint_col = c.id)
where a.month=1
and a.day=1
and a.int_col > 899
and b.float_col > 4.5
and c.string_col < '7'
and a.int_col + b.float_col + c.string_col < 1000
----
smallint, int, tinyint, int, int, float, string
----
5,5,5,5,905,5.5,'5'
6,6,6,6,906,6.6,'6'
15,15,5,5,915,5.5,'5'
16,16,6,6,916,6.6,'6'
31,31,1,1,931,6.6,'1'
32,32,2,2,932,7.7,'2'
33,33,3,3,933,8.8,'3'
34,34,4,4,934,9.9,'4'
41,41,1,1,941,6.6,'1'
42,42,2,2,942,7.7,'2'
43,43,3,3,943,8.8,'3'
44,44,4,4,944,9.9,'4'
55,55,5,5,955,5.5,'5'
56,56,6,6,956,6.6,'6'
65,65,5,5,965,5.5,'5'
66,66,6,6,966,6.6,'6'
81,81,1,1,981,6.6,'1'
82,82,2,2,982,7.7,'2'
83,83,3,3,983,8.8,'3'
84,84,4,4,984,9.9,'4'
91,91,1,1,991,6.6,'1'
====
# reversing the order produces the same results
select a.smallint_col, b.id, a.tinyint_col, c.id, a.int_col, b.float_col, c.string_col
from alltypessmall b
join alltypesagg a on (a.smallint_col = b.id)
join alltypessmall c on (a.tinyint_col = c.id)
where a.month=1
and a.day=1
and a.int_col > 899
and b.float_col > 4.5
and c.string_col < '7'
and a.int_col + b.float_col + c.string_col < 1000
----
smallint, int, tinyint, int, int, float, string
----
5,5,5,5,905,5.5,'5'
6,6,6,6,906,6.6,'6'
15,15,5,5,915,5.5,'5'
16,16,6,6,916,6.6,'6'
31,31,1,1,931,6.6,'1'
32,32,2,2,932,7.7,'2'
33,33,3,3,933,8.8,'3'
34,34,4,4,934,9.9,'4'
41,41,1,1,941,6.6,'1'
42,42,2,2,942,7.7,'2'
43,43,3,3,943,8.8,'3'
44,44,4,4,944,9.9,'4'
55,55,5,5,955,5.5,'5'
56,56,6,6,956,6.6,'6'
65,65,5,5,965,5.5,'5'
66,66,6,6,966,6.6,'6'
81,81,1,1,981,6.6,'1'
82,82,2,2,982,7.7,'2'
83,83,3,3,983,8.8,'3'
84,84,4,4,984,9.9,'4'
91,91,1,1,991,6.6,'1'
====
