select * from hbasealltypessmall where string_col = '4'
-----
int,boolean,double,float,bigint,int,smallint,tinyint,string,string
-----
14,true,40.4,4.4,40,4,4,4,'01/02/09','4'
24,true,40.4,4.4,40,4,4,4,'01/03/09','4'
29,false,40.4,4.4,40,4,4,4,'02/01/09','4'
39,false,40.4,4.4,40,4,4,4,'02/02/09','4'
4,true,40.4,4.4,40,4,4,4,'01/01/09','4'
49,false,40.4,4.4,40,4,4,4,'02/03/09','4'
54,true,40.4,4.4,40,4,4,4,'03/01/09','4'
64,true,40.4,4.4,40,4,4,4,'03/02/09','4'
74,true,40.4,4.4,40,4,4,4,'03/03/09','4'
79,false,40.4,4.4,40,4,4,4,'04/01/09','4'
89,false,40.4,4.4,40,4,4,4,'04/02/09','4'
99,false,40.4,4.4,40,4,4,4,'04/03/09','4'
=====
# make sure this works even when not requesting the col family w/ the predicate
select tinyint_col from hbasealltypessmall where string_col = '4'
----
tinyint
----
4
4
4
4
4
4
4
4
4
4
4
4
====
select count(*) from hbasealltypessmall where string_col = '4'
-----
bigint
-----
12
=====
select count(*) from hbasealltypessmall where string_col != '4'
-----
bigint
-----
88
=====
select count(*) from hbasealltypessmall where string_col < '4'
-----
bigint
-----
48
=====
select count(*) from hbasealltypessmall where string_col > '4'
-----
bigint
-----
40
=====
select count(*) from hbasealltypessmall where string_col <= '4'
-----
bigint
-----
60
=====
select count(*) from hbasealltypessmall where string_col >= '4'
-----
bigint
-----
52
=====
# empty result
select count(*) from hbasealltypessmall where string_col = '100'
-----
bigint
-----
0
=====
# multiple filters
select * from hbasealltypessmall where string_col = '4' and date_string_col = '01/01/09'
-----
int,boolean,double,float,bigint,int,smallint,tinyint,string,string
-----
4,true,40.4,4.4,40,4,4,4,'01/01/09','4'
=====
# hbase filter with regular predicate
select * from hbasealltypessmall where string_col <= '4' and int_col >= 4
-----
int,boolean,double,float,bigint,int,smallint,tinyint,string,string
-----
14,true,40.4,4.4,40,4,4,4,'01/02/09','4'
24,true,40.4,4.4,40,4,4,4,'01/03/09','4'
29,false,40.4,4.4,40,4,4,4,'02/01/09','4'
39,false,40.4,4.4,40,4,4,4,'02/02/09','4'
4,true,40.4,4.4,40,4,4,4,'01/01/09','4'
49,false,40.4,4.4,40,4,4,4,'02/03/09','4'
54,true,40.4,4.4,40,4,4,4,'03/01/09','4'
64,true,40.4,4.4,40,4,4,4,'03/02/09','4'
74,true,40.4,4.4,40,4,4,4,'03/03/09','4'
79,false,40.4,4.4,40,4,4,4,'04/01/09','4'
89,false,40.4,4.4,40,4,4,4,'04/02/09','4'
99,false,40.4,4.4,40,4,4,4,'04/03/09','4'
=====
# hbase filter with regular predicate and start/stop keys
select * from hbasestringids where string_col <= '4' and int_col >= 4 and id > '390' and id < '400'
-----
string,boolean,double,float,bigint,int,smallint,tinyint,string,string
-----
'391',false,3949.1,430.1,3910,391,91,1,'01/01/10','391'
'392',true,3959.2,431.2,3920,392,92,2,'01/01/10','392'
'393',false,3969.3,432.3,3930,393,93,3,'01/01/10','393'
'394',true,3979.4,433.4,3940,394,94,4,'01/01/10','394'
'395',false,3989.5,434.5,3950,395,95,5,'01/01/10','395'
'396',true,3999.6,435.6,3960,396,96,6,'01/01/10','396'
'397',false,4009.7,436.7,3970,397,97,7,'01/01/10','397'
'398',true,4019.8,437.8,3980,398,98,8,'01/01/10','398'
'399',false,4029.9,438.9,3990,399,99,9,'01/01/10','399'
'4',true,40.4,4.4,40,4,4,4,'01/01/10','4'
=====
# TODO: fix this, this shouldn't match every row
# comparison w/ cast doesn't turn into a predicate
#select count(*) from hbasealltypessmall where string_col >= 4
#-----
#bigint
#-----
#12
#=====
# non-const comparison doesn't turn into a predicate
select count(*) from hbasealltypessmall where string_col != date_string_col
-----
bigint
-----
100
=====
