# Based on Aggregation Queries
select int_col, sum(float_col) 
from hbasealltypessmall
where id < 5
group by 1
order by 2
limit 3
----
int,double
----
0,0
1,1.1
2,2.2
=====
# Run query without order by
select tinyint_col, count(*) 
from alltypesagg 
group by 1 
limit 10
----
tinyint, bigint
----
4,1000
5,1000
6,1000
7,1000
8,1000
9,1000
NULL,1000
1,1000
2,1000
3,1000
=====
# Same query order by asc first col
select tinyint_col, count(*) 
from alltypesagg 
group by 1 
order by 1
limit 10
----
tinyint, bigint
----
1,1000
2,1000
3,1000
4,1000
5,1000
6,1000
7,1000
8,1000
9,1000
NULL,1000
=====
# Same query order by asc first desc
select tinyint_col, count(*) 
from alltypesagg 
group by 1 
order by 1 desc
limit 20
----
tinyint, bigint
----
9,1000
8,1000
7,1000
6,1000
5,1000
4,1000
3,1000
2,1000
1,1000
NULL,1000
=====
select date_string_col,int_col
from alltypesagg
order by date_string_col, int_col desc
limit 10
----
string,int
----
'01/01/10',999
'01/01/10',998
'01/01/10',997
'01/01/10',996
'01/01/10',995
'01/01/10',994
'01/01/10',993
'01/01/10',992
'01/01/10',991
'01/01/10',990
=====
# order by multiple cols with nulls 
select tinyint_col % 3, smallint_col % 3, count(*) 
from alltypesagg 
where day = 1 
group by 1, 2
order by 1, 2
limit 20
----
tinyint, smallint, bigint
----
0,0,120
0,1,90
0,2,90
1,0,90
1,1,120
1,2,90
2,0,90
2,1,90
2,2,120
NULL,0,30
NULL,1,30
NULL,2,30
NULL,NULL,10
=====
select tinyint_col % 3, smallint_col % 3, count(*) 
from alltypesagg 
where day = 1 
group by 1, 2
order by 1, 2 desc
limit 20
----
tinyint, smallint, bigint
----
0,2,90
0,1,90
0,0,120
1,2,90
1,1,120
1,0,90
2,2,120
2,1,90
2,0,90
NULL,2,30
NULL,1,30
NULL,0,30
NULL,NULL,10
=====
select tinyint_col % 3, smallint_col % 3, count(*) 
from alltypesagg 
where day = 1 
group by 1, 2
order by 1 desc, 2
limit 20
----
tinyint, smallint, bigint
----
2,0,90
2,1,90
2,2,120
1,0,90
1,1,120
1,2,90
0,0,120
0,1,90
0,2,90
NULL,0,30
NULL,1,30
NULL,2,30
NULL,NULL,10
====
select tinyint_col % 3, smallint_col % 3, count(*) 
from alltypesagg 
where day = 1 
group by 1, 2
order by 1 desc, 2 desc
limit 20
----
tinyint, smallint, bigint
----
2,2,120
2,1,90
2,0,90
1,2,90
1,1,120
1,0,90
0,2,90
0,1,90
0,0,120
NULL,2,30
NULL,1,30
NULL,0,30
NULL,NULL,10
====
select date_string_col
from alltypessmall
order by date_string_col desc
limit 50
----
string
----
'04/03/09'
'04/03/09'
'04/03/09'
'04/03/09'
'04/03/09'
'04/02/09'
'04/02/09'
'04/02/09'
'04/02/09'
'04/02/09'
'04/02/09'
'04/02/09'
'04/02/09'
'04/02/09'
'04/02/09'
'04/01/09'
'04/01/09'
'04/01/09'
'04/01/09'
'04/01/09'
'04/01/09'
'04/01/09'
'04/01/09'
'04/01/09'
'04/01/09'
'03/03/09'
'03/03/09'
'03/03/09'
'03/03/09'
'03/03/09'
'03/02/09'
'03/02/09'
'03/02/09'
'03/02/09'
'03/02/09'
'03/02/09'
'03/02/09'
'03/02/09'
'03/02/09'
'03/02/09'
'03/01/09'
'03/01/09'
'03/01/09'
'03/01/09'
'03/01/09'
'03/01/09'
'03/01/09'
'03/01/09'
'03/01/09'
'03/01/09'
=====
# Based on join queries
select a.tinyint_col, b.id, a.string_col
from alltypesagg a join alltypessmall b on (a.tinyint_col = b.id)
where a.month=1
and a.day=1
and a.tinyint_col + b.tinyint_col < 5
and a.string_col > '88'
and b.bool_col = false
order by a.string_col
limit 5
----
tinyint, int, string
----
1,1,'881'
1,1,'891'
1,1,'901'
1,1,'91'
1,1,'911'
====
select a.tinyint_col, b.id, a.string_col
from alltypesagg a join alltypessmall b on (a.tinyint_col = b.id)
where a.month=1
and a.day=1
and a.tinyint_col + b.tinyint_col < 5
and a.string_col > '88'
and b.bool_col = false
order by a.string_col desc
limit 5
----
tinyint, int, string
----
1,1,'991'
1,1,'981'
1,1,'971'
1,1,'961'
1,1,'951'
====
select a.smallint_col, b.id, a.tinyint_col, c.id, a.int_col, b.float_col, c.string_col
from alltypesagg a
join alltypessmall b on (a.smallint_col = b.id)
join alltypessmall c on (a.tinyint_col = c.id)
where a.month=1
and a.day=1
and a.int_col > 899
and b.float_col > 4.5
and c.string_col < '7'
and a.int_col + b.float_col + c.string_col < 1000
order by c.string_col desc, a.smallint_col
limit 10
----
smallint, int, tinyint, int, int, float, string
----
6,6,6,6,906,6.6,'6'
16,16,6,6,916,6.6,'6'
56,56,6,6,956,6.6,'6'
66,66,6,6,966,6.6,'6'
5,5,5,5,905,5.5,'5'
15,15,5,5,915,5.5,'5'
55,55,5,5,955,5.5,'5'
65,65,5,5,965,5.5,'5'
34,34,4,4,934,9.9,'4'
44,44,4,4,944,9.9,'4'
====
# Order by a column that is not in the select list 
# Query with ordering column in select list
select int_col, tinyint_col, date_string_col
from alltypessmall
order by int_col desc
limit 20
----
int, tinyint, string
----
9,9,'03/02/09'
9,9,'04/02/09'
9,9,'02/01/09'
9,9,'01/02/09'
9,9,'04/01/09'
9,9,'01/01/09'
9,9,'03/01/09'
9,9,'02/02/09'
8,8,'01/02/09'
8,8,'02/01/09'
8,8,'04/02/09'
8,8,'01/01/09'
8,8,'02/02/09'
8,8,'03/02/09'
8,8,'03/01/09'
8,8,'04/01/09'
7,7,'03/01/09'
7,7,'02/02/09'
7,7,'03/02/09'
7,7,'01/01/09'
====
# Same query with ordering col not in select list
select tinyint_col, date_string_col
from alltypessmall
order by int_col desc
limit 20
----
tinyint, string
----
9,'03/02/09'
9,'04/02/09'
9,'02/01/09'
9,'01/02/09'
9,'04/01/09'
9,'01/01/09'
9,'03/01/09'
9,'02/02/09'
8,'01/02/09'
8,'02/01/09'
8,'04/02/09'
8,'01/01/09'
8,'02/02/09'
8,'03/02/09'
8,'03/01/09'
8,'04/01/09'
7,'03/01/09'
7,'02/02/09'
7,'03/02/09'
7,'01/01/09'
====
# Order by many exprs
select year, month, count(*) 
from alltypes 
group by 1, 2
order by 1, 2
limit 100
----
int, int, bigint
----
2009,1,310
2009,2,280
2009,3,310
2009,4,300
2009,5,310
2009,6,300
2009,7,310
2009,8,310
2009,9,300
2009,10,310
2009,11,300
2009,12,310
2010,1,310
2010,2,280
2010,3,310
2010,4,300
2010,5,310
2010,6,300
2010,7,310
2010,8,310
2010,9,300
2010,10,310
2010,11,300
2010,12,310
====
# More Complex Ordering Exprs
select int_col % 7, count(*), avg(tinyint_col)
from alltypesagg
group by 1
order by avg(tinyint_col)
limit 10
----
int, bigint, double
----
4,1430,4.9845
6,1420,4.99219
1,1430,4.99225
3,1430,5
5,1430,5.00775
0,1420,5.00781
2,1430,5.0155
NULL,10,NULL
====
select int_col % 7, count(*), max(int_col)
from alltypesagg
group by 1
order by max(int_col)
limit 10
----
int, bigint, int
----
6,1420,993
0,1420,994
1,1430,995
2,1430,996
3,1430,997
4,1430,998
5,1430,999
NULL,10,NULL
====
select int_col % 5, count(*), avg(tinyint_col) - avg(float_col)
from alltypesagg
group by 1
order by avg(tinyint_col) - avg(float_col) desc
limit 10
----
int, bigint, double
----
1,2000,-544.85
2,2000,-544.95
0,1990,-545
3,2000,-545.05
4,2000,-545.15
NULL,10,NULL
====
select int_col
from alltypessmall
order by int_col % 5
limit 100
----
int
----
0
0
5
0
5
5
0
0
5
0
5
0
5
0
0
5
5
0
0
0
1
6
1
1
6
6
1
6
1
1
1
1
1
1
6
1
6
1
6
6
2
2
7
2
2
2
2
7
7
7
2
2
7
2
7
2
7
7
2
2
3
3
8
3
3
3
3
8
3
8
8
8
3
3
3
3
8
8
8
3
9
4
4
9
9
4
9
4
4
4
9
4
9
9
9
4
4
4
4
4
====
