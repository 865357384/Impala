select year, count(*) from alltypes group by 1
----
int, bigint
----
2009,3650
2010,3650
====
select month, count(*) from alltypes group by 1
----
int, bigint
----
8,620
9,600
10,620
11,600
12,620
1,620
2,560
3,620
4,600
5,620
6,600
7,620
====
select year, month, count(*) from alltypes group by 1, 2
----
int, int, bigint
----
2010,2,280
2009,5,310
2010,1,310
2009,6,300
2009,3,310
2009,4,300
2009,9,300
2009,10,310
2010,6,300
2009,7,310
2010,5,310
2009,8,310
2010,4,300
2010,3,310
2010,10,310
2009,11,300
2010,9,300
2009,12,310
2010,8,310
2010,7,310
2010,12,310
2010,11,300
2009,1,310
2009,2,280
====
select count(*) from alltypes where year=2009
----
bigint
----
3650
====
# still works if 'year' needs a cast
select count(*) from alltypes where year = 2009.0
----
bigint
----
3650
====
# finds bindings for partition keys regardless of order of operands
select count(*) from alltypes where 2009 = year
----
bigint
----
3650
====
select count(*) from alltypes where 2009.0 = year
----
bigint
----
3650
====
select count(*) from alltypes where month=1
----
bigint
----
620
====
select count(*) from alltypes where year=2009 and month=1
----
bigint
----
310
====
select count(*) from alltypes where year=2009 and month > 6
----
bigint
----
1840
====
select count(*) from alltypes where year=2009 and month < 6
----
bigint
----
1510
====
select count(*) from alltypes where year<=2009 and month < 6
----
bigint
----
1510
====
select count(*) from alltypes where month < 9 and month > 6
----
bigint
----
1240
====
select count(*) from alltypes where year < 2010 and year < 2009 and month > 6
----
bigint
----
0
====
select count(*) from alltypes where year < 2010 and month > 6 and month > 12
----
bigint
----
0
====
