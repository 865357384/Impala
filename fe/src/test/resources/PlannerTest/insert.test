# insert into an unpartitioned table
insert into table alltypesnopart
select id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, 
float_col, double_col, date_string_col, string_col
from alltypes
where year=2009 and month=05
----
WRITE TO HDFS table=default.alltypesnopart
  OVERWRITE=false
SCAN HDFS table=default.alltypes
  REGEX: ^file:/.*/year=([^\/]*)/month=([^\/]*)/
  FILES:
    file:fe/target/test-warehouse/alltypes/year=2009/month=5/090501.txt
----
WRITE TO HDFS table=default.alltypesnopart
  OVERWRITE=false
EXCHANGE ID: 1
----
STREAM DATA SINK
  EXCHANGE ID: 1
SCAN HDFS table=default.alltypes
  REGEX: ^file:/.*/year=([^\/]*)/month=([^\/]*)/
  FILES:
    file:fe/target/test-warehouse/alltypes/year=2009/month=5/090501.txt
====
# insert into a static partition
insert into table alltypessmall
partition (year=2009, month=04) 
select id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, 
float_col, double_col, date_string_col, string_col
from alltypes
where year=2009 and month=05
----
WRITE TO HDFS table=default.alltypessmall
  OVERWRITE=false
  PARTITIONS: 2009,4
SCAN HDFS table=default.alltypes
  REGEX: ^file:/.*/year=([^\/]*)/month=([^\/]*)/
  FILES:
    file:fe/target/test-warehouse/alltypes/year=2009/month=5/090501.txt
----
WRITE TO HDFS table=default.alltypessmall
  OVERWRITE=false
  PARTITIONS: 2009,4
EXCHANGE ID: 1
----
STREAM DATA SINK
  EXCHANGE ID: 1
SCAN HDFS table=default.alltypes
  REGEX: ^file:/.*/year=([^\/]*)/month=([^\/]*)/
  FILES:
    file:fe/target/test-warehouse/alltypes/year=2009/month=5/090501.txt
====
# overwrite a static partition
insert overwrite table alltypessmall
partition (year=2009, month=04) 
select id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, 
float_col, double_col, date_string_col, string_col
from alltypes
where year=2009 and month=05
----
WRITE TO HDFS table=default.alltypessmall
  OVERWRITE=true
  PARTITIONS: 2009,4
SCAN HDFS table=default.alltypes
  REGEX: ^file:/.*/year=([^\/]*)/month=([^\/]*)/
  FILES:
    file:fe/target/test-warehouse/alltypes/year=2009/month=5/090501.txt
----
WRITE TO HDFS table=default.alltypessmall
  OVERWRITE=true
  PARTITIONS: 2009,4
EXCHANGE ID: 1
----
STREAM DATA SINK
  EXCHANGE ID: 1
SCAN HDFS table=default.alltypes
  REGEX: ^file:/.*/year=([^\/]*)/month=([^\/]*)/
  FILES:
    file:fe/target/test-warehouse/alltypes/year=2009/month=5/090501.txt
====
# insert into a fully dynamic partition
insert into table alltypessmall
partition (year, month) 
select id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, 
float_col, double_col, date_string_col, string_col, year, month
from alltypes
where year=2009 and month>10
----
WRITE TO HDFS table=default.alltypessmall
  OVERWRITE=false
  PARTITIONS: year,month
SCAN HDFS table=default.alltypes
  REGEX: ^file:/.*/year=([^\/]*)/month=([^\/]*)/
  FILES:
    file:fe/target/test-warehouse/alltypes/year=2009/month=11/091101.txt
    file:fe/target/test-warehouse/alltypes/year=2009/month=12/091201.txt
----
WRITE TO HDFS table=default.alltypessmall
  OVERWRITE=false
  PARTITIONS: year,month
EXCHANGE ID: 1
----
STREAM DATA SINK
  EXCHANGE ID: 1
SCAN HDFS table=default.alltypes
  REGEX: ^file:/.*/year=([^\/]*)/month=([^\/]*)/
  FILES:
    file:fe/target/test-warehouse/alltypes/year=2009/month=11/091101.txt
    file:fe/target/test-warehouse/alltypes/year=2009/month=12/091201.txt
====
# insert into a partially dynamic partition
insert into table alltypessmall
partition (year=2009, month) 
select id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, 
float_col, double_col, date_string_col, string_col, month
from alltypes
where year=2009 and month>10
----
WRITE TO HDFS table=default.alltypessmall
  OVERWRITE=false
  PARTITIONS: 2009,month
SCAN HDFS table=default.alltypes
  REGEX: ^file:/.*/year=([^\/]*)/month=([^\/]*)/
  FILES:
    file:fe/target/test-warehouse/alltypes/year=2009/month=11/091101.txt
    file:fe/target/test-warehouse/alltypes/year=2009/month=12/091201.txt
----
WRITE TO HDFS table=default.alltypessmall
  OVERWRITE=false
  PARTITIONS: 2009,month
EXCHANGE ID: 1
----
STREAM DATA SINK
  EXCHANGE ID: 1
SCAN HDFS table=default.alltypes
  REGEX: ^file:/.*/year=([^\/]*)/month=([^\/]*)/
  FILES:
    file:fe/target/test-warehouse/alltypes/year=2009/month=11/091101.txt
    file:fe/target/test-warehouse/alltypes/year=2009/month=12/091201.txt
====
# insert into a partially dynamic partition
insert into table alltypessmall
partition (year, month=4) 
select id, bool_col, tinyint_col, smallint_col, int_col, bigint_col, 
float_col, double_col, date_string_col, string_col, year
from alltypes
where year>2009 and month=4
----
WRITE TO HDFS table=default.alltypessmall
  OVERWRITE=false
  PARTITIONS: year,4
SCAN HDFS table=default.alltypes
  REGEX: ^file:/.*/year=([^\/]*)/month=([^\/]*)/
  FILES:
    file:fe/target/test-warehouse/alltypes/year=2010/month=4/100401.txt
----
WRITE TO HDFS table=default.alltypessmall
  OVERWRITE=false
  PARTITIONS: year,4
EXCHANGE ID: 1
----
STREAM DATA SINK
  EXCHANGE ID: 1
SCAN HDFS table=default.alltypes
  REGEX: ^file:/.*/year=([^\/]*)/month=([^\/]*)/
  FILES:
    file:fe/target/test-warehouse/alltypes/year=2010/month=4/100401.txt