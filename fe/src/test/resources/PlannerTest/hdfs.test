# predicate is evaluated by the scan node
select zip, count(*)
from testtbl
where name like 'm%'
group by 1
----
Plan Fragment 0
  AGGREGATE
  OUTPUT: COUNT(*)
  GROUP BY: zip
    SCAN HDFS table=default.testtbl (0)
      PREDICATES: name LIKE 'm%'
------------
Plan Fragment 0
  AGGREGATE
  OUTPUT: SUM(<slot 3>)
  GROUP BY: <slot 2>
    EXCHANGE (2)

Plan Fragment 1
  STREAM DATA SINK
    EXCHANGE ID: 2
  AGGREGATE
  OUTPUT: COUNT(*)
  GROUP BY: zip
    SCAN HDFS table=default.testtbl (0)
      PREDICATES: name LIKE 'm%'
====
# all partitions are selected
select * from alltypes
----
Plan Fragment 0
  SCAN HDFS table=default.alltypes (0)
    REGEX: .*/year=([^\/]*)/month=([^\/]*)/

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypes/year=2009/month=1/090101.txt 0:13034
        hdfs:alltypes/year=2009/month=10/091001.txt 0:13454
        hdfs:alltypes/year=2009/month=11/091101.txt 0:13020
        hdfs:alltypes/year=2009/month=12/091201.txt 0:13454
        hdfs:alltypes/year=2009/month=2/090201.txt 0:11872
        hdfs:alltypes/year=2009/month=3/090301.txt 0:13144
        hdfs:alltypes/year=2009/month=4/090401.txt 0:12920
        hdfs:alltypes/year=2009/month=5/090501.txt 0:13454
        hdfs:alltypes/year=2009/month=6/090601.txt 0:13020
        hdfs:alltypes/year=2009/month=7/090701.txt 0:13454
        hdfs:alltypes/year=2009/month=8/090801.txt 0:13454
        hdfs:alltypes/year=2009/month=9/090901.txt 0:13020
        hdfs:alltypes/year=2010/month=1/100101.txt 0:13454
        hdfs:alltypes/year=2010/month=10/101001.txt 0:13454
        hdfs:alltypes/year=2010/month=11/101101.txt 0:13020
        hdfs:alltypes/year=2010/month=12/101201.txt 0:13454
        hdfs:alltypes/year=2010/month=2/100201.txt 0:12152
        hdfs:alltypes/year=2010/month=3/100301.txt 0:13454
        hdfs:alltypes/year=2010/month=4/100401.txt 0:13020
        hdfs:alltypes/year=2010/month=5/100501.txt 0:13454
        hdfs:alltypes/year=2010/month=6/100601.txt 0:13020
        hdfs:alltypes/year=2010/month=7/100701.txt 0:13454
        hdfs:alltypes/year=2010/month=8/100801.txt 0:13454
        hdfs:alltypes/year=2010/month=9/100901.txt 0:13020
------------
Plan Fragment 0
  EXCHANGE (1)

Plan Fragment 1
  STREAM DATA SINK
    EXCHANGE ID: 1
  SCAN HDFS table=default.alltypes (0)
    REGEX: .*/year=([^\/]*)/month=([^\/]*)/

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypes/year=2009/month=1/090101.txt 0:13034
        hdfs:alltypes/year=2009/month=10/091001.txt 0:13454
        hdfs:alltypes/year=2009/month=11/091101.txt 0:13020
        hdfs:alltypes/year=2009/month=12/091201.txt 0:13454
        hdfs:alltypes/year=2009/month=2/090201.txt 0:11872
        hdfs:alltypes/year=2009/month=3/090301.txt 0:13144
        hdfs:alltypes/year=2009/month=4/090401.txt 0:12920
        hdfs:alltypes/year=2009/month=5/090501.txt 0:13454
        hdfs:alltypes/year=2009/month=6/090601.txt 0:13020
        hdfs:alltypes/year=2009/month=7/090701.txt 0:13454
        hdfs:alltypes/year=2009/month=8/090801.txt 0:13454
        hdfs:alltypes/year=2009/month=9/090901.txt 0:13020
        hdfs:alltypes/year=2010/month=1/100101.txt 0:13454
        hdfs:alltypes/year=2010/month=10/101001.txt 0:13454
        hdfs:alltypes/year=2010/month=11/101101.txt 0:13020
        hdfs:alltypes/year=2010/month=12/101201.txt 0:13454
        hdfs:alltypes/year=2010/month=2/100201.txt 0:12152
        hdfs:alltypes/year=2010/month=3/100301.txt 0:13454
        hdfs:alltypes/year=2010/month=4/100401.txt 0:13020
        hdfs:alltypes/year=2010/month=5/100501.txt 0:13454
        hdfs:alltypes/year=2010/month=6/100601.txt 0:13020
        hdfs:alltypes/year=2010/month=7/100701.txt 0:13454
        hdfs:alltypes/year=2010/month=8/100801.txt 0:13454
        hdfs:alltypes/year=2010/month=9/100901.txt 0:13020
====
# predicate on first partition key
select * from alltypes where year = 2009
----
Plan Fragment 0
  SCAN HDFS table=default.alltypes (0)
    REGEX: .*/year=([^\/]*)/month=([^\/]*)/

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypes/year=2009/month=1/090101.txt 0:13034
        hdfs:alltypes/year=2009/month=10/091001.txt 0:13454
        hdfs:alltypes/year=2009/month=11/091101.txt 0:13020
        hdfs:alltypes/year=2009/month=12/091201.txt 0:13454
        hdfs:alltypes/year=2009/month=2/090201.txt 0:11872
        hdfs:alltypes/year=2009/month=3/090301.txt 0:13144
        hdfs:alltypes/year=2009/month=4/090401.txt 0:12920
        hdfs:alltypes/year=2009/month=5/090501.txt 0:13454
        hdfs:alltypes/year=2009/month=6/090601.txt 0:13020
        hdfs:alltypes/year=2009/month=7/090701.txt 0:13454
        hdfs:alltypes/year=2009/month=8/090801.txt 0:13454
        hdfs:alltypes/year=2009/month=9/090901.txt 0:13020
------------
Plan Fragment 0
  EXCHANGE (1)

Plan Fragment 1
  STREAM DATA SINK
    EXCHANGE ID: 1
  SCAN HDFS table=default.alltypes (0)
    REGEX: .*/year=([^\/]*)/month=([^\/]*)/

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypes/year=2009/month=1/090101.txt 0:13034
        hdfs:alltypes/year=2009/month=10/091001.txt 0:13454
        hdfs:alltypes/year=2009/month=11/091101.txt 0:13020
        hdfs:alltypes/year=2009/month=12/091201.txt 0:13454
        hdfs:alltypes/year=2009/month=2/090201.txt 0:11872
        hdfs:alltypes/year=2009/month=3/090301.txt 0:13144
        hdfs:alltypes/year=2009/month=4/090401.txt 0:12920
        hdfs:alltypes/year=2009/month=5/090501.txt 0:13454
        hdfs:alltypes/year=2009/month=6/090601.txt 0:13020
        hdfs:alltypes/year=2009/month=7/090701.txt 0:13454
        hdfs:alltypes/year=2009/month=8/090801.txt 0:13454
        hdfs:alltypes/year=2009/month=9/090901.txt 0:13020
====
# same predicate, phrased differently
select * from alltypes where year = 2009.0
----
Plan Fragment 0
  SCAN HDFS table=default.alltypes (0)
    REGEX: .*/year=([^\/]*)/month=([^\/]*)/

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypes/year=2009/month=1/090101.txt 0:13034
        hdfs:alltypes/year=2009/month=10/091001.txt 0:13454
        hdfs:alltypes/year=2009/month=11/091101.txt 0:13020
        hdfs:alltypes/year=2009/month=12/091201.txt 0:13454
        hdfs:alltypes/year=2009/month=2/090201.txt 0:11872
        hdfs:alltypes/year=2009/month=3/090301.txt 0:13144
        hdfs:alltypes/year=2009/month=4/090401.txt 0:12920
        hdfs:alltypes/year=2009/month=5/090501.txt 0:13454
        hdfs:alltypes/year=2009/month=6/090601.txt 0:13020
        hdfs:alltypes/year=2009/month=7/090701.txt 0:13454
        hdfs:alltypes/year=2009/month=8/090801.txt 0:13454
        hdfs:alltypes/year=2009/month=9/090901.txt 0:13020
------------
Plan Fragment 0
  EXCHANGE (1)

Plan Fragment 1
  STREAM DATA SINK
    EXCHANGE ID: 1
  SCAN HDFS table=default.alltypes (0)
    REGEX: .*/year=([^\/]*)/month=([^\/]*)/

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypes/year=2009/month=1/090101.txt 0:13034
        hdfs:alltypes/year=2009/month=10/091001.txt 0:13454
        hdfs:alltypes/year=2009/month=11/091101.txt 0:13020
        hdfs:alltypes/year=2009/month=12/091201.txt 0:13454
        hdfs:alltypes/year=2009/month=2/090201.txt 0:11872
        hdfs:alltypes/year=2009/month=3/090301.txt 0:13144
        hdfs:alltypes/year=2009/month=4/090401.txt 0:12920
        hdfs:alltypes/year=2009/month=5/090501.txt 0:13454
        hdfs:alltypes/year=2009/month=6/090601.txt 0:13020
        hdfs:alltypes/year=2009/month=7/090701.txt 0:13454
        hdfs:alltypes/year=2009/month=8/090801.txt 0:13454
        hdfs:alltypes/year=2009/month=9/090901.txt 0:13020
====
select * from alltypes where 2009 = year
----
Plan Fragment 0
  SCAN HDFS table=default.alltypes (0)
    REGEX: .*/year=([^\/]*)/month=([^\/]*)/

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypes/year=2009/month=1/090101.txt 0:13034
        hdfs:alltypes/year=2009/month=10/091001.txt 0:13454
        hdfs:alltypes/year=2009/month=11/091101.txt 0:13020
        hdfs:alltypes/year=2009/month=12/091201.txt 0:13454
        hdfs:alltypes/year=2009/month=2/090201.txt 0:11872
        hdfs:alltypes/year=2009/month=3/090301.txt 0:13144
        hdfs:alltypes/year=2009/month=4/090401.txt 0:12920
        hdfs:alltypes/year=2009/month=5/090501.txt 0:13454
        hdfs:alltypes/year=2009/month=6/090601.txt 0:13020
        hdfs:alltypes/year=2009/month=7/090701.txt 0:13454
        hdfs:alltypes/year=2009/month=8/090801.txt 0:13454
        hdfs:alltypes/year=2009/month=9/090901.txt 0:13020
------------
Plan Fragment 0
  EXCHANGE (1)

Plan Fragment 1
  STREAM DATA SINK
    EXCHANGE ID: 1
  SCAN HDFS table=default.alltypes (0)
    REGEX: .*/year=([^\/]*)/month=([^\/]*)/

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypes/year=2009/month=1/090101.txt 0:13034
        hdfs:alltypes/year=2009/month=10/091001.txt 0:13454
        hdfs:alltypes/year=2009/month=11/091101.txt 0:13020
        hdfs:alltypes/year=2009/month=12/091201.txt 0:13454
        hdfs:alltypes/year=2009/month=2/090201.txt 0:11872
        hdfs:alltypes/year=2009/month=3/090301.txt 0:13144
        hdfs:alltypes/year=2009/month=4/090401.txt 0:12920
        hdfs:alltypes/year=2009/month=5/090501.txt 0:13454
        hdfs:alltypes/year=2009/month=6/090601.txt 0:13020
        hdfs:alltypes/year=2009/month=7/090701.txt 0:13454
        hdfs:alltypes/year=2009/month=8/090801.txt 0:13454
        hdfs:alltypes/year=2009/month=9/090901.txt 0:13020
====
select * from alltypes where 2009.0 = year
----
Plan Fragment 0
  SCAN HDFS table=default.alltypes (0)
    REGEX: .*/year=([^\/]*)/month=([^\/]*)/

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypes/year=2009/month=1/090101.txt 0:13034
        hdfs:alltypes/year=2009/month=10/091001.txt 0:13454
        hdfs:alltypes/year=2009/month=11/091101.txt 0:13020
        hdfs:alltypes/year=2009/month=12/091201.txt 0:13454
        hdfs:alltypes/year=2009/month=2/090201.txt 0:11872
        hdfs:alltypes/year=2009/month=3/090301.txt 0:13144
        hdfs:alltypes/year=2009/month=4/090401.txt 0:12920
        hdfs:alltypes/year=2009/month=5/090501.txt 0:13454
        hdfs:alltypes/year=2009/month=6/090601.txt 0:13020
        hdfs:alltypes/year=2009/month=7/090701.txt 0:13454
        hdfs:alltypes/year=2009/month=8/090801.txt 0:13454
        hdfs:alltypes/year=2009/month=9/090901.txt 0:13020
------------
Plan Fragment 0
  EXCHANGE (1)

Plan Fragment 1
  STREAM DATA SINK
    EXCHANGE ID: 1
  SCAN HDFS table=default.alltypes (0)
    REGEX: .*/year=([^\/]*)/month=([^\/]*)/

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypes/year=2009/month=1/090101.txt 0:13034
        hdfs:alltypes/year=2009/month=10/091001.txt 0:13454
        hdfs:alltypes/year=2009/month=11/091101.txt 0:13020
        hdfs:alltypes/year=2009/month=12/091201.txt 0:13454
        hdfs:alltypes/year=2009/month=2/090201.txt 0:11872
        hdfs:alltypes/year=2009/month=3/090301.txt 0:13144
        hdfs:alltypes/year=2009/month=4/090401.txt 0:12920
        hdfs:alltypes/year=2009/month=5/090501.txt 0:13454
        hdfs:alltypes/year=2009/month=6/090601.txt 0:13020
        hdfs:alltypes/year=2009/month=7/090701.txt 0:13454
        hdfs:alltypes/year=2009/month=8/090801.txt 0:13454
        hdfs:alltypes/year=2009/month=9/090901.txt 0:13020
====
# predicate on second partition key
select * from alltypes where month=1
----
Plan Fragment 0
  SCAN HDFS table=default.alltypes (0)
    REGEX: .*/year=([^\/]*)/month=([^\/]*)/

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypes/year=2009/month=1/090101.txt 0:13034
        hdfs:alltypes/year=2010/month=1/100101.txt 0:13454
------------
Plan Fragment 0
  EXCHANGE (1)

Plan Fragment 1
  STREAM DATA SINK
    EXCHANGE ID: 1
  SCAN HDFS table=default.alltypes (0)
    REGEX: .*/year=([^\/]*)/month=([^\/]*)/

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypes/year=2009/month=1/090101.txt 0:13034
        hdfs:alltypes/year=2010/month=1/100101.txt 0:13454
====
# predicate on both partition keys
select * from alltypes where year=2009 and month=1
----
Plan Fragment 0
  SCAN HDFS table=default.alltypes (0)
    REGEX: .*/year=([^\/]*)/month=([^\/]*)/

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypes/year=2009/month=1/090101.txt 0:13034
------------
Plan Fragment 0
  EXCHANGE (1)

Plan Fragment 1
  STREAM DATA SINK
    EXCHANGE ID: 1
  SCAN HDFS table=default.alltypes (0)
    REGEX: .*/year=([^\/]*)/month=([^\/]*)/

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypes/year=2009/month=1/090101.txt 0:13034
====
# single-sided range on 2nd key
select * from alltypes where year=2009 and month > 6
----
Plan Fragment 0
  SCAN HDFS table=default.alltypes (0)
    REGEX: .*/year=([^\/]*)/month=([^\/]*)/

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypes/year=2009/month=10/091001.txt 0:13454
        hdfs:alltypes/year=2009/month=11/091101.txt 0:13020
        hdfs:alltypes/year=2009/month=12/091201.txt 0:13454
        hdfs:alltypes/year=2009/month=7/090701.txt 0:13454
        hdfs:alltypes/year=2009/month=8/090801.txt 0:13454
        hdfs:alltypes/year=2009/month=9/090901.txt 0:13020
------------
Plan Fragment 0
  EXCHANGE (1)

Plan Fragment 1
  STREAM DATA SINK
    EXCHANGE ID: 1
  SCAN HDFS table=default.alltypes (0)
    REGEX: .*/year=([^\/]*)/month=([^\/]*)/

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypes/year=2009/month=10/091001.txt 0:13454
        hdfs:alltypes/year=2009/month=11/091101.txt 0:13020
        hdfs:alltypes/year=2009/month=12/091201.txt 0:13454
        hdfs:alltypes/year=2009/month=7/090701.txt 0:13454
        hdfs:alltypes/year=2009/month=8/090801.txt 0:13454
        hdfs:alltypes/year=2009/month=9/090901.txt 0:13020
====
select * from alltypes where year=2009 and month < 6
----
Plan Fragment 0
  SCAN HDFS table=default.alltypes (0)
    REGEX: .*/year=([^\/]*)/month=([^\/]*)/

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypes/year=2009/month=1/090101.txt 0:13034
        hdfs:alltypes/year=2009/month=2/090201.txt 0:11872
        hdfs:alltypes/year=2009/month=3/090301.txt 0:13144
        hdfs:alltypes/year=2009/month=4/090401.txt 0:12920
        hdfs:alltypes/year=2009/month=5/090501.txt 0:13454
------------
Plan Fragment 0
  EXCHANGE (1)

Plan Fragment 1
  STREAM DATA SINK
    EXCHANGE ID: 1
  SCAN HDFS table=default.alltypes (0)
    REGEX: .*/year=([^\/]*)/month=([^\/]*)/

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypes/year=2009/month=1/090101.txt 0:13034
        hdfs:alltypes/year=2009/month=2/090201.txt 0:11872
        hdfs:alltypes/year=2009/month=3/090301.txt 0:13144
        hdfs:alltypes/year=2009/month=4/090401.txt 0:12920
        hdfs:alltypes/year=2009/month=5/090501.txt 0:13454
====
# single-sided ranges on both keys
select * from alltypes where year<=2009 and month < 6
----
Plan Fragment 0
  SCAN HDFS table=default.alltypes (0)
    REGEX: .*/year=([^\/]*)/month=([^\/]*)/

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypes/year=2009/month=1/090101.txt 0:13034
        hdfs:alltypes/year=2009/month=2/090201.txt 0:11872
        hdfs:alltypes/year=2009/month=3/090301.txt 0:13144
        hdfs:alltypes/year=2009/month=4/090401.txt 0:12920
        hdfs:alltypes/year=2009/month=5/090501.txt 0:13454
------------
Plan Fragment 0
  EXCHANGE (1)

Plan Fragment 1
  STREAM DATA SINK
    EXCHANGE ID: 1
  SCAN HDFS table=default.alltypes (0)
    REGEX: .*/year=([^\/]*)/month=([^\/]*)/

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypes/year=2009/month=1/090101.txt 0:13034
        hdfs:alltypes/year=2009/month=2/090201.txt 0:11872
        hdfs:alltypes/year=2009/month=3/090301.txt 0:13144
        hdfs:alltypes/year=2009/month=4/090401.txt 0:12920
        hdfs:alltypes/year=2009/month=5/090501.txt 0:13454
====
# range on 2nd key
select * from alltypes where month < 9 and month > 6
----
Plan Fragment 0
  SCAN HDFS table=default.alltypes (0)
    REGEX: .*/year=([^\/]*)/month=([^\/]*)/

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypes/year=2009/month=7/090701.txt 0:13454
        hdfs:alltypes/year=2009/month=8/090801.txt 0:13454
        hdfs:alltypes/year=2010/month=7/100701.txt 0:13454
        hdfs:alltypes/year=2010/month=8/100801.txt 0:13454
------------
Plan Fragment 0
  EXCHANGE (1)

Plan Fragment 1
  STREAM DATA SINK
    EXCHANGE ID: 1
  SCAN HDFS table=default.alltypes (0)
    REGEX: .*/year=([^\/]*)/month=([^\/]*)/

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypes/year=2009/month=7/090701.txt 0:13454
        hdfs:alltypes/year=2009/month=8/090801.txt 0:13454
        hdfs:alltypes/year=2010/month=7/100701.txt 0:13454
        hdfs:alltypes/year=2010/month=8/100801.txt 0:13454
====
# multiple predicates on first key; 2nd one applied as predicate
select * from alltypes where year < 2010 and year < 2009 and month > 6
----
Plan Fragment 0
  SCAN HDFS table=default.alltypes (0)
    PREDICATES: year < 2009
    REGEX: .*/year=([^\/]*)/month=([^\/]*)/

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypes/year=2009/month=10/091001.txt 0:13454
        hdfs:alltypes/year=2009/month=11/091101.txt 0:13020
        hdfs:alltypes/year=2009/month=12/091201.txt 0:13454
        hdfs:alltypes/year=2009/month=7/090701.txt 0:13454
        hdfs:alltypes/year=2009/month=8/090801.txt 0:13454
        hdfs:alltypes/year=2009/month=9/090901.txt 0:13020
------------
Plan Fragment 0
  EXCHANGE (1)

Plan Fragment 1
  STREAM DATA SINK
    EXCHANGE ID: 1
  SCAN HDFS table=default.alltypes (0)
    PREDICATES: year < 2009
    REGEX: .*/year=([^\/]*)/month=([^\/]*)/

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypes/year=2009/month=10/091001.txt 0:13454
        hdfs:alltypes/year=2009/month=11/091101.txt 0:13020
        hdfs:alltypes/year=2009/month=12/091201.txt 0:13454
        hdfs:alltypes/year=2009/month=7/090701.txt 0:13454
        hdfs:alltypes/year=2009/month=8/090801.txt 0:13454
        hdfs:alltypes/year=2009/month=9/090901.txt 0:13020
====
# multiple predicates on second key; 2nd one applied as predicate
select * from alltypes where year < 2010 and month > 6 and month > 8
----
Plan Fragment 0
  SCAN HDFS table=default.alltypes (0)
    PREDICATES: month > 8
    REGEX: .*/year=([^\/]*)/month=([^\/]*)/

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypes/year=2009/month=10/091001.txt 0:13454
        hdfs:alltypes/year=2009/month=11/091101.txt 0:13020
        hdfs:alltypes/year=2009/month=12/091201.txt 0:13454
        hdfs:alltypes/year=2009/month=7/090701.txt 0:13454
        hdfs:alltypes/year=2009/month=8/090801.txt 0:13454
        hdfs:alltypes/year=2009/month=9/090901.txt 0:13020
------------
Plan Fragment 0
  EXCHANGE (1)

Plan Fragment 1
  STREAM DATA SINK
    EXCHANGE ID: 1
  SCAN HDFS table=default.alltypes (0)
    PREDICATES: month > 8
    REGEX: .*/year=([^\/]*)/month=([^\/]*)/

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypes/year=2009/month=10/091001.txt 0:13454
        hdfs:alltypes/year=2009/month=11/091101.txt 0:13020
        hdfs:alltypes/year=2009/month=12/091201.txt 0:13454
        hdfs:alltypes/year=2009/month=7/090701.txt 0:13454
        hdfs:alltypes/year=2009/month=8/090801.txt 0:13454
        hdfs:alltypes/year=2009/month=9/090901.txt 0:13020
====
# slot binding can't be determined
select * from alltypes where year - 1 = 2009
----
Plan Fragment 0
  SCAN HDFS table=default.alltypes (0)
    PREDICATES: year - 1 = 2009
    REGEX: .*/year=([^\/]*)/month=([^\/]*)/

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypes/year=2009/month=1/090101.txt 0:13034
        hdfs:alltypes/year=2009/month=10/091001.txt 0:13454
        hdfs:alltypes/year=2009/month=11/091101.txt 0:13020
        hdfs:alltypes/year=2009/month=12/091201.txt 0:13454
        hdfs:alltypes/year=2009/month=2/090201.txt 0:11872
        hdfs:alltypes/year=2009/month=3/090301.txt 0:13144
        hdfs:alltypes/year=2009/month=4/090401.txt 0:12920
        hdfs:alltypes/year=2009/month=5/090501.txt 0:13454
        hdfs:alltypes/year=2009/month=6/090601.txt 0:13020
        hdfs:alltypes/year=2009/month=7/090701.txt 0:13454
        hdfs:alltypes/year=2009/month=8/090801.txt 0:13454
        hdfs:alltypes/year=2009/month=9/090901.txt 0:13020
        hdfs:alltypes/year=2010/month=1/100101.txt 0:13454
        hdfs:alltypes/year=2010/month=10/101001.txt 0:13454
        hdfs:alltypes/year=2010/month=11/101101.txt 0:13020
        hdfs:alltypes/year=2010/month=12/101201.txt 0:13454
        hdfs:alltypes/year=2010/month=2/100201.txt 0:12152
        hdfs:alltypes/year=2010/month=3/100301.txt 0:13454
        hdfs:alltypes/year=2010/month=4/100401.txt 0:13020
        hdfs:alltypes/year=2010/month=5/100501.txt 0:13454
        hdfs:alltypes/year=2010/month=6/100601.txt 0:13020
        hdfs:alltypes/year=2010/month=7/100701.txt 0:13454
        hdfs:alltypes/year=2010/month=8/100801.txt 0:13454
        hdfs:alltypes/year=2010/month=9/100901.txt 0:13020
------------
Plan Fragment 0
  EXCHANGE (1)

Plan Fragment 1
  STREAM DATA SINK
    EXCHANGE ID: 1
  SCAN HDFS table=default.alltypes (0)
    PREDICATES: year - 1 = 2009
    REGEX: .*/year=([^\/]*)/month=([^\/]*)/

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypes/year=2009/month=1/090101.txt 0:13034
        hdfs:alltypes/year=2009/month=10/091001.txt 0:13454
        hdfs:alltypes/year=2009/month=11/091101.txt 0:13020
        hdfs:alltypes/year=2009/month=12/091201.txt 0:13454
        hdfs:alltypes/year=2009/month=2/090201.txt 0:11872
        hdfs:alltypes/year=2009/month=3/090301.txt 0:13144
        hdfs:alltypes/year=2009/month=4/090401.txt 0:12920
        hdfs:alltypes/year=2009/month=5/090501.txt 0:13454
        hdfs:alltypes/year=2009/month=6/090601.txt 0:13020
        hdfs:alltypes/year=2009/month=7/090701.txt 0:13454
        hdfs:alltypes/year=2009/month=8/090801.txt 0:13454
        hdfs:alltypes/year=2009/month=9/090901.txt 0:13020
        hdfs:alltypes/year=2010/month=1/100101.txt 0:13454
        hdfs:alltypes/year=2010/month=10/101001.txt 0:13454
        hdfs:alltypes/year=2010/month=11/101101.txt 0:13020
        hdfs:alltypes/year=2010/month=12/101201.txt 0:13454
        hdfs:alltypes/year=2010/month=2/100201.txt 0:12152
        hdfs:alltypes/year=2010/month=3/100301.txt 0:13454
        hdfs:alltypes/year=2010/month=4/100401.txt 0:13020
        hdfs:alltypes/year=2010/month=5/100501.txt 0:13454
        hdfs:alltypes/year=2010/month=6/100601.txt 0:13020
        hdfs:alltypes/year=2010/month=7/100701.txt 0:13454
        hdfs:alltypes/year=2010/month=8/100801.txt 0:13454
        hdfs:alltypes/year=2010/month=9/100901.txt 0:13020
====
# multi files non-partitioned table test
select * from alltypesaggmultifilesNoPart
----
Plan Fragment 0
  SCAN HDFS table=default.alltypesaggmultifilesnopart (0)

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypesaggmultifilesnopart/000000_0 0:130652
        hdfs:alltypesaggmultifilesnopart/000000_0_copy_1 0:132212
        hdfs:alltypesaggmultifilesnopart/000000_0_copy_2 0:130273
        hdfs:alltypesaggmultifilesnopart/000000_0_copy_3 0:132163
------------
Plan Fragment 0
  EXCHANGE (1)

Plan Fragment 1
  STREAM DATA SINK
    EXCHANGE ID: 1
  SCAN HDFS table=default.alltypesaggmultifilesnopart (0)

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypesaggmultifilesnopart/000000_0 0:130652
        hdfs:alltypesaggmultifilesnopart/000000_0_copy_1 0:132212
        hdfs:alltypesaggmultifilesnopart/000000_0_copy_2 0:130273
        hdfs:alltypesaggmultifilesnopart/000000_0_copy_3 0:132163
====
# multi files partitioned table test
select * from alltypesaggmultifiles where day<=2
----
Plan Fragment 0
  SCAN HDFS table=default.alltypesaggmultifiles (0)
    REGEX: .*/year=([^\/]*)/month=([^\/]*)/day=([^\/]*)/

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypesaggmultifiles/year=2010/month=1/day=1/000000_0 0:12815
        hdfs:alltypesaggmultifiles/year=2010/month=1/day=1/000000_0_copy_1 0:12971
        hdfs:alltypesaggmultifiles/year=2010/month=1/day=1/000000_0_copy_2 0:12778
        hdfs:alltypesaggmultifiles/year=2010/month=1/day=1/000000_0_copy_3 0:12967
        hdfs:alltypesaggmultifiles/year=2010/month=1/day=2/000000_0 0:13093
        hdfs:alltypesaggmultifiles/year=2010/month=1/day=2/000000_0_copy_1 0:13249
        hdfs:alltypesaggmultifiles/year=2010/month=1/day=2/000000_0_copy_2 0:13055
        hdfs:alltypesaggmultifiles/year=2010/month=1/day=2/000000_0_copy_3 0:13244
------------
Plan Fragment 0
  EXCHANGE (1)

Plan Fragment 1
  STREAM DATA SINK
    EXCHANGE ID: 1
  SCAN HDFS table=default.alltypesaggmultifiles (0)
    REGEX: .*/year=([^\/]*)/month=([^\/]*)/day=([^\/]*)/

  EXEC PARAMS
    HOST: 
      HDFS SPLITS NODE ID: 0
        hdfs:alltypesaggmultifiles/year=2010/month=1/day=1/000000_0 0:12815
        hdfs:alltypesaggmultifiles/year=2010/month=1/day=1/000000_0_copy_1 0:12971
        hdfs:alltypesaggmultifiles/year=2010/month=1/day=1/000000_0_copy_2 0:12778
        hdfs:alltypesaggmultifiles/year=2010/month=1/day=1/000000_0_copy_3 0:12967
        hdfs:alltypesaggmultifiles/year=2010/month=1/day=2/000000_0 0:13093
        hdfs:alltypesaggmultifiles/year=2010/month=1/day=2/000000_0_copy_1 0:13249
        hdfs:alltypesaggmultifiles/year=2010/month=1/day=2/000000_0_copy_2 0:13055
        hdfs:alltypesaggmultifiles/year=2010/month=1/day=2/000000_0_copy_3 0:13244
====
